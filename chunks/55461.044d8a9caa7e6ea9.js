"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[55461],{10307:(e,t,o)=>{o.d(t,{A:()=>j});var r,n,l,i,a=o(14654),s=o(65890),c=o(30598),u=o.n(c),d=o(83034),m=o(15447),p=o(51717);function f(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var h=(0,o(11577).rU)(function(e){var t=e.prefixCls,o=e.css,a=e.token;return{low:o(r||(r=f(["\n      color: ",";\n    "])),a.colorWarningText),normal:o(n||(n=f(["\n      color: ",";\n    "])),a.colorSuccessText),overload:o(l||(l=f(["\n      color: ",";\n    "])),a.colorErrorText),root:o(i||(i=f(["\n      user-select: none;\n      min-width: fit-content;\n      height: 28px;\n      &.","-btn {\n        padding-block: 12px;\n        &.","-btn-round {\n          padding-inline: 6px 12px;\n        }\n        &.","-btn-square {\n          padding-inline: 6px 12px;\n        }\n      }\n    "])),t,t,t)}}),y=o(54898);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var v=["className","shape","mode","maxValue","value","text","unoptimized","hideText","ref"];function b(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,r)}return o}function x(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?b(Object(o),!0).forEach(function(t){var r,n,l;r=e,n=t,l=o[t],(n=function(e){var t=function(e,t){if("object"!=g(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var r=o.call(e,t||"default");if("object"!=g(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==g(t)?t:String(t)}(n))in r?Object.defineProperty(r,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):r[n]=l}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):b(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}var w=function(e){return u()(e).format("0,0")},k=(0,d.memo)(function(e){var t=e.className,o=e.shape,r=e.mode,n=void 0===r?"remained":r,l=e.maxValue,i=e.value,c=e.text,u=e.unoptimized,f=e.hideText,g=e.ref,b=function(e,t){if(null==e)return{};var o,r,n=function(e,t){if(null==e)return{};var o,r,n={},l=Object.keys(e);for(r=0;r<l.length;r++)o=l[r],t.indexOf(o)>=0||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)o=l[r],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}(e,v),k=(0,a.Q)().mobile,j=l-i,O=j/l,F=(0,d.useMemo)(function(){var e,t;return O>.3?(e="normal",t="\uD83D\uDE00"):O>0?(e="low",t="\uD83D\uDE05"):(e="overload",t="\uD83E\uDD2F"),{emoji:t,type:e}},[O]),S=h(),T=S.styles,D=S.cx,P=(0,d.useMemo)(function(){return(0,s.F)(T.root,{defaultVariants:{type:"normal"},variants:{type:{normal:T.normal,low:T.low,overload:T.overload}}})},[T]);return(0,y.jsxs)(m.A,x(x({className:D(P({type:F.type}),t),ref:g,shape:void 0===o?"round":o,variant:"filled"},b),{},{children:[(0,y.jsx)(p.A,{emoji:F.emoji,size:18,unoptimized:u}),j>0?[!f&&!k?"remained"===n?(null==c?void 0:c.remained)||"Remained":(null==c?void 0:c.used)||"Used":"","remained"===n?w(j):w(i)].join(" "):(null==c?void 0:c.overload)||"Overload"]}))});k.displayName="TokenTag";let j=k},26683:(e,t,o)=>{o.d(t,{M:()=>i});var r=o(47878),n=o(83034),l=o(29261);let i=(e="")=>{let[t,o]=(0,n.useState)(0),i=(0,n.useCallback)((0,r.A)(e=>{(0,l.X)(e).then(o).catch(()=>{o(e.length)})},300),[]);return(0,n.useEffect)(()=>((0,n.startTransition)(()=>{i(e||"")}),()=>{i.cancel()}),[e,i]),t}},36362:(e,t,o)=>{o.d(t,{A:()=>d});var r=o(28802),n=o(49875),l=o(11577),i=o(30598),a=o.n(i),s=o(83034),c=o(80457);let u=e=>a()(e).format("0,0"),d=(0,s.memo)(({data:e,showIcon:t,showTotal:o})=>{let i=(0,l.DP)(),a=e.reduce((e,t)=>e+t.value,0);return(0,r.FD)(c.Flexbox,{gap:8,style:{position:"relative"},width:"100%",children:[(0,r.Y)(c.Flexbox,{height:6,horizontal:!0,style:{background:0===a?i.colorFill:void 0,borderRadius:3,overflow:"hidden",position:"relative"},width:"100%",children:e.map(e=>(0,r.Y)(c.Flexbox,{height:"100%",style:{background:e.color,flex:e.value}},e.id))}),(0,r.FD)(c.Flexbox,{children:[e.map(e=>(0,r.FD)(c.Flexbox,{align:"center",gap:4,horizontal:!0,justify:"space-between",children:[(0,r.FD)(c.Flexbox,{align:"center",gap:4,horizontal:!0,children:[t&&(0,r.Y)("div",{style:{background:e.color,borderRadius:"50%",flex:"none",height:6,width:6}}),(0,r.Y)("div",{style:{color:i.colorTextSecondary},children:e.title})]}),(0,r.Y)("div",{style:{fontWeight:500},children:u(e.value)})]},e.id)),o&&(0,r.FD)(r.FK,{children:[(0,r.Y)(n.A,{style:{marginBlock:8}}),(0,r.FD)(c.Flexbox,{align:"center",gap:4,horizontal:!0,justify:"space-between",children:[(0,r.Y)("div",{style:{color:i.colorTextSecondary},children:o}),(0,r.Y)("div",{style:{fontWeight:500},children:u(a)})]})]})]})]})})},55461:(e,t,o)=>{o.r(t),o.d(t,{default:()=>N});var r=o(28802),n=o(15361),l=o(37412),i=o(10307),a=o(11577),s=o(30598),c=o.n(s),u=o(83034),d=o(59121),m=o(80457),p=o(20480),f=o(32559),h=o(76301),y=o(82668),g=o(26683),v=o(45541),b=o(88990),x=o(17068),w=o(71171),k=o(84354),j=o(40473),O=o(50243),F=o(64811),S=o(62016),T=o(74038),D=o(35863),P=o(61520),A=o(38759),M=o(82340),Y=o(36362);let C=(0,u.memo)(({total:e})=>{let{t}=(0,d.Bd)(["chat","components"]),o=(0,a.DP)(),s=(0,x.L)(e=>e.inputMessage),C=(0,x.L)(e=>e.activeTopicId),[N,z]=(0,v.o)(e=>[b.e.currentAgentModel(e),b.e.currentAgentModelProvider(e)]),E=(0,F.B)(S.z.currentGroupAgents),I=(0,F.B)(e=>e.activeId),L=(0,O.u)(j.a.currentGroupConfig),W=(0,x.L)(e=>I&&e.supervisorTodos[(0,k.T)(I,C)]||[]),R=(0,h.o)(N,z),B=(0,y.L)(N,z),G=(0,u.useMemo)(()=>{if(!E||0===E.length)return[];let e=new Set;return E.forEach(t=>{t.plugins&&t.plugins.forEach(t=>e.add(t))}),Array.from(e)},[E]).map(e=>e.id),U=(0,T.j)(e=>{let{tools:t,enabledToolIds:o}=(0,f.wp)({model:N,provider:z}).generateToolsDetailed({model:N,provider:z,toolIds:G}),r=t?.map(e=>JSON.stringify(e)).join("")||"";return D.P.enabledSystemRoles(o)(e)+r}),V=(0,g.M)(B?U:""),_=(0,u.useMemo)(()=>{if(!E||0===E.length)return"";try{let e=w.fA.mainAIChatsWithHistoryConfig(x.L.getState()),t=(0,A.c)(),o=P.f.nickName(t)||"User",r=[{id:"user",title:o},...(E||[]).map(e=>({id:e.id||"",title:e.title||""}))],l=E[0];if(!l)return"";let i=l.systemRole||"";return n.FM.buildGroupChatSystemPrompt({agentId:l.id||"",baseSystemRole:i,groupMembers:r,messages:e})+"\n\nNow it's your turn to respond. You are sending message to the group publicly. Please respond as this agent would, considering the full conversation history provided above. Directly return the message content, no other text. You do not need add author name or anything else."}catch(e){return console.warn("Failed to calculate system role tokens:",e),""}},[E,e]),H=(0,g.M)(_),K=(0,u.useMemo)(()=>{if(!E||0===E.length)return"";try{let e=w.fA.mainAIChatsWithHistoryConfig(x.L.getState());if(!e||0===e.length)return"";let t=(0,n.rj)(e),o=(0,A.c)(),r=P.f.nickName(o)||"User";return n.FM.buildSupervisorPrompt({availableAgents:E.filter(e=>e.id).map(e=>({id:e.id,title:e.title})),conversationHistory:t,systemPrompt:L.systemPrompt,todoList:W,userName:r})}catch(e){return console.warn("Failed to calculate supervisor tokens:",e),""}},[E,L.systemPrompt,e,W]),q=(0,g.M)(K),J=(0,g.M)(s),Q=(0,u.useMemo)(()=>w.fA.mainAIChatsWithHistoryConfig(x.L.getState()).map(e=>e.content).join(""),[e]),X=(0,g.M)(Q)+J,Z=H+V+X+q,$=(0,r.FD)(m.Flexbox,{gap:12,style:{minWidth:200},children:[(0,r.FD)(m.Flexbox,{align:"center",gap:4,horizontal:!0,justify:"space-between",width:"100%",children:[(0,r.Y)("div",{style:{color:o.colorTextDescription},children:t("tokenDetails.title")}),(0,r.Y)(l.A,{styles:{root:{maxWidth:"unset",pointerEvents:"none"}},title:t("ModelSelect.featureTag.tokens",{ns:"components",tokens:c()(R).format("0,0")}),children:(0,r.Y)(p.default,{height:20,paddingInline:4,style:{background:o.colorFillTertiary,borderRadius:4,color:o.colorTextSecondary,fontFamily:o.fontFamilyCode,fontSize:11},children:"TOKEN"})})]}),(0,r.Y)(Y.A,{data:[{color:o.magenta,id:"systemRole",title:t("tokenDetails.systemRole"),value:H},{color:o.geekblue,id:"tools",title:t("tokenDetails.tools"),value:V},...q>0?[{color:o.purple,id:"supervisor",title:t("tokenDetails.supervisor"),value:q}]:[],{color:o.gold,id:"chats",title:t("tokenDetails.chats"),value:X}],showIcon:!0}),(0,r.Y)(Y.A,{data:[{color:o.colorSuccess,id:"used",title:t("tokenDetails.used"),value:Z},{color:o.colorFill,id:"rest",title:t("tokenDetails.rest"),value:R-Z}],showIcon:!0,showTotal:t("tokenDetails.total")})]});return(0,r.Y)(M.A,{content:$,children:(0,r.Y)(i.A,{maxValue:R,mode:"used",style:{marginLeft:8},text:{overload:t("tokenTag.overload"),remained:t("tokenTag.remained"),used:t("tokenTag.used")},value:Z})})});C.displayName="TokenTagForGroupChat";let N=C},76301:(e,t,o)=>{o.d(t,{o:()=>l});var r=o(94147),n=o(81196);let l=(e,t)=>(0,r.d)(n.g.modelContextWindowTokens(e,t))}}]);