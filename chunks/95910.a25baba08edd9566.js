"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95910],{95910:(e,l,r)=>{r.r(l),r.d(l,{default:()=>w});var a=r(28802),n=r(28726),t=r(75431),i=r(80122),d=r(80176),o=r(58244),s=r(59202),c=r(42507),y=r(36475),p=r(89098),u=r(53809),x=r(49875),h=r(28755),b=r(31021),A=r.n(b),g=r(83034),m=r(59121),F=r(80457),Y=r(90396),v=r(64694);let P=()=>{let{t:e}=(0,m.Bd)("electron"),[l]=d.A.useForm(),{message:r}=o.A.useApp(),[b,P]=(0,g.useState)("https://www.google.com"),[k,w]=(0,g.useState)(!1),[D,q]=(0,g.useState)(!1),[C,S]=(0,g.useState)(null),[f,R]=(0,g.useState)(!1),I=d.A.useWatch("enableProxy",l),V=d.A.useWatch("proxyRequireAuth",l),[z,B]=(0,v.p)(e=>[e.setProxySettings,e.useGetProxySettings]),{data:T,isLoading:Z}=B();(0,g.useEffect)(()=>{T&&(l.setFieldsValue(T),R(!1))},[l,T]);let _=(0,g.useCallback)(()=>{R(!0),S(null)},[]),E=e=>{let r=l.getFieldsValue();l.setFieldsValue(e);let a=l.getFieldsValue();A()(a,r)||_()},N=(0,g.useCallback)(async()=>{try{q(!0);let a=await l.validateFields();await z(a),R(!1),r.success(e("proxy.saveSuccess"))}catch(l){l instanceof Error&&r.error(e("proxy.saveFailed",{error:l.message}))}finally{q(!1)}},[l,e,r]),U=(0,g.useCallback)(()=>{T&&(l.setFieldsValue(T),R(!1),S(null))},[l,T]),W=(0,g.useCallback)(async()=>{try{w(!0),S(null);let e=await l.validateFields(),r={...T,...e},a=await Y.x.testProxyConfig(r,b);S(a)}catch(l){S({message:l instanceof Error?l.message:"Unknown error",success:!1}),r.error(e("proxy.testFailed"))}finally{w(!1)}},[T,b]);return Z?(0,a.Y)(s.A,{}):(0,a.Y)(d.A,{disabled:D,form:l,layout:"vertical",onValuesChange:_,requiredMark:!1,children:(0,a.FD)(F.Flexbox,{gap:24,children:[(0,a.Y)(n.A,{paddingBlock:16,paddingInline:24,style:{borderRadius:12},variant:"outlined",children:(0,a.Y)(d.A.Item,{name:"enableProxy",noStyle:!0,valuePropName:"checked",children:(0,a.FD)(F.Flexbox,{align:"center",horizontal:!0,justify:"space-between",children:[(0,a.FD)(F.Flexbox,{children:[(0,a.Y)(t.A,{as:"h4",children:e("proxy.enable")}),(0,a.Y)(t.A,{type:"secondary",children:e("proxy.enableDesc")})]}),(0,a.Y)(c.A,{checked:I,onChange:e=>{E({enableProxy:e})}})]})})}),(0,a.Y)(n.A,{paddingBlock:16,paddingInline:24,style:{borderRadius:12},variant:"outlined",children:(0,a.FD)(F.Flexbox,{gap:24,children:[(0,a.FD)(F.Flexbox,{children:[(0,a.Y)(t.A,{as:"h4",children:e("proxy.basicSettings")}),(0,a.Y)(t.A,{type:"secondary",children:e("proxy.basicSettingsDesc")})]}),(0,a.FD)(F.Flexbox,{children:[(0,a.Y)(d.A.Item,{dependencies:["enableProxy"],label:e("proxy.type"),name:"proxyType",rules:[({getFieldValue:l})=>({message:e("proxy.validation.typeRequired"),required:l("enableProxy")})],children:(0,a.FD)(y.Ay.Group,{disabled:!l.getFieldValue("enableProxy"),children:[(0,a.Y)(y.Ay,{value:"http",children:"HTTP"}),(0,a.Y)(y.Ay,{value:"https",children:"HTTPS"}),(0,a.Y)(y.Ay,{value:"socks5",children:"SOCKS5"})]})}),(0,a.FD)(p.A.Compact,{style:{width:"100%"},children:[(0,a.Y)(d.A.Item,{dependencies:["enableProxy"],label:e("proxy.server"),name:"proxyServer",rules:[({getFieldValue:l})=>({message:e("proxy.validation.serverRequired"),required:l("enableProxy")}),{message:e("proxy.validation.serverInvalid"),pattern:/^((25[0-5]|2[0-4]\d|[01]?\d{1,2})\.){3}(25[0-5]|2[0-4]\d|[01]?\d{1,2})$|^[\dA-Za-z]([\dA-Za-z-]*[\dA-Za-z])?(\.[\dA-Za-z]([\dA-Za-z-]*[\dA-Za-z])?)*$/}],style:{flex:1,marginBottom:0},children:(0,a.Y)(u.A,{disabled:!l.getFieldValue("enableProxy"),placeholder:"127.0.0.1"})}),(0,a.Y)(d.A.Item,{dependencies:["enableProxy"],label:e("proxy.port"),name:"proxyPort",rules:[({getFieldValue:l})=>({message:e("proxy.validation.portRequired"),required:l("enableProxy")}),{message:e("proxy.validation.portInvalid"),pattern:/^([1-9]\d{0,3}|[1-5]\d{4}|6[0-4]\d{3}|65[0-4]\d{2}|655[0-2]\d|6553[0-5])$/}],style:{marginBottom:0,width:120},children:(0,a.Y)(u.A,{disabled:!l.getFieldValue("enableProxy"),placeholder:"7890"})})]})]}),(0,a.Y)(x.A,{size:"small"}),(0,a.FD)(F.Flexbox,{gap:12,children:[(0,a.Y)(d.A.Item,{dependencies:["enableProxy"],name:"proxyRequireAuth",noStyle:!0,valuePropName:"checked",children:(0,a.FD)(F.Flexbox,{align:"center",horizontal:!0,justify:"space-between",children:[(0,a.FD)(F.Flexbox,{children:[(0,a.Y)(t.A,{as:"h5",children:e("proxy.auth")}),(0,a.Y)(t.A,{type:"secondary",children:e("proxy.authDesc")})]}),(0,a.Y)(c.A,{checked:V,disabled:!I,onChange:e=>{E({proxyRequireAuth:e})}})]})}),(0,a.Y)(d.A.Item,{dependencies:["proxyRequireAuth","enableProxy"],label:e("proxy.username"),name:"proxyUsername",rules:[({getFieldValue:l})=>({message:e("proxy.validation.usernameRequired"),required:l("proxyRequireAuth")&&l("enableProxy")})],style:{display:l.getFieldValue("proxyRequireAuth")&&l.getFieldValue("enableProxy")?"block":"none"},children:(0,a.Y)(u.A,{placeholder:e("proxy.username_placeholder")})}),(0,a.Y)(d.A.Item,{dependencies:["proxyRequireAuth","enableProxy"],label:e("proxy.password"),name:"proxyPassword",rules:[({getFieldValue:l})=>({message:e("proxy.validation.passwordRequired"),required:l("proxyRequireAuth")&&l("enableProxy")})],style:{display:l.getFieldValue("proxyRequireAuth")&&l.getFieldValue("enableProxy")?"block":"none"},children:(0,a.Y)(u.A.Password,{placeholder:e("proxy.password_placeholder")})})]})]})}),(0,a.Y)(n.A,{paddingBlock:16,paddingInline:24,style:{borderRadius:12},variant:"outlined",children:(0,a.FD)(F.Flexbox,{gap:24,children:[(0,a.FD)(F.Flexbox,{children:[(0,a.Y)(t.A,{as:"h4",children:e("proxy.connectionTest")}),(0,a.Y)(t.A,{type:"secondary",children:e("proxy.testDescription")})]}),(0,a.Y)(d.A.Item,{label:e("proxy.testUrl"),children:(0,a.FD)(F.Flexbox,{gap:8,children:[(0,a.FD)(p.A.Compact,{style:{width:"100%"},children:[(0,a.Y)(u.A,{onChange:e=>P(e.target.value),placeholder:e("proxy.testUrlPlaceholder"),style:{flex:1},value:b}),(0,a.Y)(h.Ay,{loading:k,onClick:W,type:"default",children:e("proxy.testButton")})]}),C?C.success?(0,a.Y)(i.A,{closable:!0,message:(0,a.Y)(F.Flexbox,{align:"center",gap:8,horizontal:!0,children:e("proxy.testSuccessWithTime",{time:C.responseTime})}),type:"success"}):(0,a.Y)(i.A,{closable:!0,message:(0,a.FD)(F.Flexbox,{align:"center",gap:8,horizontal:!0,children:[e("proxy.testFailed"),": ",C.message]}),type:"error",variant:"outlined"}):null]})})]})}),(0,a.FD)(p.A,{children:[(0,a.Y)(h.Ay,{disabled:!f,loading:D,onClick:N,type:"primary",children:e("proxy.saveButton")}),(0,a.Y)(h.Ay,{disabled:!f||D,onClick:U,children:e("proxy.resetButton")}),f&&(0,a.Y)(t.A,{style:{marginLeft:8},type:"warning",children:e("proxy.unsavedChanges")})]})]})})},k=()=>(0,a.Y)("div",{style:{maxWidth:"1024px",width:"100%"},children:(0,a.Y)(P,{})});k.displayName="ProxySettings";let w=k}}]);