"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[14343,50493,64694],{14343:(e,t,r)=>{r.d(t,{e2:()=>a,dispatch:()=>o,$l:()=>s,A8:()=>l});let o=async(e,...t)=>{if(!window.electronAPI||!window.electronAPI.invoke)throw Error(`electronAPI.invoke not found. Please expose \`ipcRenderer.invoke\` to \`window.electronAPI.invoke\` in the preload:

import { contextBridge, ipcRenderer } from 'electron';

const invoke = async (event, ...data) =>
  ipcRenderer.invoke(event, ...data);

contextBridge.exposeInMainWorld('electronAPI', { invoke });
`);return window.electronAPI.invoke(e,...t)},n=async e=>{if(e){if("string"==typeof e||e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if(e instanceof Blob)return await e.arrayBuffer();throw console.warn("不支持的 IPC 代理请求体类型:",typeof e),Error("不支持的 IPC 代理请求体类型")}},s=async(e,t)=>{var r;let o,s=new URL(e.toString(),window.location.origin),i=s.pathname+s.search,a=t?.method?.toUpperCase()||"GET",c=(r=t?.headers,o={},r&&(r instanceof Headers?r.forEach((e,t)=>{o[t]=e}):Array.isArray(r)?r.forEach(([e,t])=>{o[e]=t}):Object.assign(o,r),delete o.host,delete o.connection,delete o["content-length"]),o),l={body:await n(t?.body),headers:c,method:a,urlPath:i};return new Promise((e,t)=>{let r,o=!1,n=new ReadableStream({cancel(){s?.()},start(e){r=e}}),s=window.electronAPI.onStreamInvoke(l,{onData:e=>{r&&r.enqueue(e)},onEnd:()=>{r&&r.close()},onError:e=>{console.error("[streamInvoke] Error during IPC stream proxy call:",e),o?r&&r.error(e):(o=!0,t(e))},onResponse:t=>{o||(o=!0,e(new Response(n,t)))}})})};var i,a=((i={}).Cloud="cloud",i.Local="local",i.SelfHost="selfHost",i),c=r(83034);let l=(e,t)=>{(0,c.useEffect)(()=>{if(!window.electron)return;let r=(e,r)=>{t(r)};return window.electron.ipcRenderer.on(e,r),()=>{window.electron.ipcRenderer.removeListener(e,r)}},[])}},32092:(e,t,r)=>{r.d(t,{H:()=>c});var o=r(45541),n=r(64811),s=r(38759),i=r(61520),a=r(3296);let c=e=>{let[t]=(0,o.o)(e=>[e.useFetchAgentConfig]),r=(0,s.k)(i.P.isLogin),c=t(r,(0,n.B)(t=>{if(e){let r=t.sessions?.find(t=>t.type===a.r.Agent&&t.config?.id===e);return r?.id||t.activeId}return t.activeId}));return{...c,isLoading:c.isLoading&&r}}},37844:(e,t,r)=>{r.d(t,{remoteServerService:()=>s});var o=r(14343);class n{constructor(){this.getRemoteServerConfig=async()=>(0,o.dispatch)("getRemoteServerConfig"),this.setRemoteServerConfig=async e=>(0,o.dispatch)("setRemoteServerConfig",e),this.clearRemoteServerConfig=async()=>(0,o.dispatch)("clearRemoteServerConfig"),this.requestAuthorization=async e=>(0,o.dispatch)("requestAuthorization",e),this.requestMarketAuthorization=async e=>(0,o.dispatch)("requestMarketAuthorization",e)}}let s=new n},38128:(e,t,r)=>{r.d(t,{A:()=>s});var o=r(83034),n=r(98724);let s=(0,o.memo)(({title:e})=>((0,o.useEffect)(()=>{document.title=e?`${e} \xb7 ${n.Se}`:n.Se},[e]),null))},42379:(e,t,r)=>{r.d(t,{A:()=>i});var o=r(28802),n=r(80457);let s=({children:e,withNav:t,style:r,header:s,id:i="lobe-mobile-scroll-container",...a})=>{let c=(0,o.Y)(n.Flexbox,{height:"100%",id:i,style:{overflowX:"hidden",overflowY:"auto",position:"relative",...r,paddingBottom:t?48:r?.paddingBottom},width:"100%",...a,children:e});return s?(0,o.FD)(n.Flexbox,{height:"100%",style:{overflow:"hidden",position:"relative"},width:"100%",children:[s,(0,o.Y)(n.Flexbox,{height:"100%",id:"lobe-mobile-scroll-container",style:{overflowX:"hidden",overflowY:"auto",position:"relative",...r,paddingBottom:t?48:r?.paddingBottom},width:"100%",...a,children:e})]}):c};s.displayName="MobileContentLayout";let i=s},50759:(e,t,r)=>{r.d(t,{N:()=>s});let o="__LOBE_GLOBAL_AGENT_CONTEXT__";class n{get context(){return window[o]||(window[o]={}),window[o]}set context(e){window[o]=e}getContext(){return this.context}updateContext(e){this.context={...this.context,...e}}setContext(e){this.context=e}fillTemplate(e){let t=this.getContext();return e?e.replaceAll(/{{([^}]+)}}/g,(e,r)=>{let o=r.trim();return void 0!==t[o]?String(t[o]):"[N/A]"}):""}}let s=new n},60062:(e,t,r)=>{r.d(t,{p$:()=>n});var o=r(11577);let n={draggable:(0,o.cx)((0,o.AH)`
  -webkit-app-region: drag;
`),nodrag:(0,o.cx)((0,o.AH)`
  -webkit-app-region: no-drag;
`)}},64464:(e,t,r)=>{r.d(t,{electronSystemService:()=>s});var o=r(14343);class n{async getAppState(){return(0,o.dispatch)("getDesktopAppState")}async closeWindow(){return(0,o.dispatch)("closeWindow")}async maximizeWindow(){return(0,o.dispatch)("maximizeWindow")}async minimizeWindow(){return(0,o.dispatch)("minimizeWindow")}constructor(){this.showContextMenu=async(e,t)=>(0,o.dispatch)("showContextMenu",{data:t,type:e})}}let s=new n},64694:(e,t,r)=>{r.d(t,{R:()=>x,p:()=>C});var o=r(50786),n=r(23993),s=r(41734),i=r(46265),a=r(64464),c=r(50759),l=r(67095),d=r(31021),p=r.n(d),h=r(64911),g=r(85366),y=r(90396);let u="electron:getProxySettings",S="electron:getDesktopHotkeys";var f=r(37844);let w={appState:{},dataSyncConfig:{storageMode:"local"},desktopHotkeys:{},isAppStateInit:!1,isConnectingServer:!1,isDesktopHotkeysInit:!1,isInitRemoteServerConfig:!1,isSyncActive:!1,proxySettings:{enableProxy:!1,proxyBypass:"localhost, 127.0.0.1, ::1",proxyPort:"",proxyRequireAuth:!1,proxyServer:"",proxyType:"http"}},v="electron:getRemoteServerConfig",m=(0,s.t)("electron"),C=(0,n.h)()(m((...e)=>({...w,...((e,t)=>({connectRemoteServer:async r=>{if("selfHost"!==r.storageMode||r.remoteServerUrl){e({isConnectingServer:!0});try{let o=await f.remoteServerService.getRemoteServerConfig();p()(o,r)||await f.remoteServerService.setRemoteServerConfig({...r,active:!1});let n=await f.remoteServerService.requestAuthorization(r);n.success||(console.error("请求授权失败:",n.error),e({remoteServerSyncError:{message:n.error,type:"AUTH_ERROR"}})),await t().refreshServerConfig()}catch(t){console.error("远程服务器配置出错:",t),e({remoteServerSyncError:{message:t.message,type:"CONFIG_ERROR"}})}finally{e({isConnectingServer:!1})}}},disconnectRemoteServer:async()=>{e({isConnectingServer:!1});try{await f.remoteServerService.setRemoteServerConfig({active:!1,storageMode:"local"}),e({dataSyncConfig:w.dataSyncConfig}),await t().refreshServerConfig()}catch(t){console.error("断开连接失败:",t),e({remoteServerSyncError:{message:t.message,type:"DISCONNECT_ERROR"}})}finally{e({isConnectingServer:!1})}},refreshServerConfig:async()=>{await (0,h.j)(v)},refreshUserData:async()=>{let{getSessionStoreState:e}=await Promise.all([r.e(30173),r.e(6312),r.e(75113),r.e(83663),r.e(85614),r.e(71828),r.e(59440),r.e(96987),r.e(83897),r.e(16748),r.e(72389),r.e(31871),r.e(14946),r.e(64811),r.e(69373)]).then(r.bind(r,55442)),{getChatStoreState:t}=await Promise.all([r.e(30173),r.e(6312),r.e(75113),r.e(83663),r.e(85614),r.e(71828),r.e(59440),r.e(96987),r.e(83897),r.e(16748),r.e(72389),r.e(31871),r.e(14946),r.e(64811),r.e(48501)]).then(r.bind(r,28410)),{getUserStoreState:o}=await Promise.all([r.e(6312),r.e(9467)]).then(r.bind(r,9467));await e().refreshSessions(),await t().refreshMessages(),await t().refreshTopic(),await o().refreshUserState()},useDataSyncConfig:()=>(0,g.Ay)(v,async()=>{try{return await f.remoteServerService.getRemoteServerConfig()}catch(e){throw console.error("获取远程服务器配置失败:",e),e}},{onSuccess:r=>{p()(r,t().dataSyncConfig)||t().refreshUserData(),e({dataSyncConfig:r,isInitRemoteServerConfig:!0})}})}))(...e),...((e,t)=>({updateElectronAppState:r=>{let o=t().appState;e({appState:(0,l.h)(o,r)})},useInitElectronAppState:()=>(0,i.Ju)("initElectronAppState",async()=>a.electronSystemService.getAppState(),{onSuccess:t=>{e({appState:t,isAppStateInit:!0},!1,"initElectronAppState"),c.N.updateContext({desktopPath:t.userPath.desktop,documentsPath:t.userPath.documents,downloadsPath:t.userPath.downloads,homePath:t.userPath.home,musicPath:t.userPath.music,picturesPath:t.userPath.pictures,userDataPath:t.userPath.userData,videosPath:t.userPath.videos})}})}))(...e),...((e,t)=>({refreshDesktopHotkeys:async()=>{await (0,h.j)(S)},refreshProxySettings:async()=>{await (0,h.j)(u)},setProxySettings:async e=>{try{await y.x.setSettings(e),await t().refreshProxySettings()}catch(e){console.error("代理设置更新失败:",e)}},updateDesktopHotkey:async(e,r)=>{try{let o=await y.x.updateDesktopHotkey(e,r);return o.success&&await t().refreshDesktopHotkeys(),o}catch(e){return console.error("桌面热键更新失败:",e),{errorType:"UNKNOWN",success:!1}}},useFetchDesktopHotkeys:()=>(0,g.Ay)(S,async()=>y.x.getDesktopHotkeys(),{onSuccess:r=>{p()(r,t().desktopHotkeys)||e({desktopHotkeys:r,isDesktopHotkeysInit:!0})}}),useGetProxySettings:()=>(0,g.Ay)(u,async()=>y.x.getProxySettings(),{onSuccess:r=>{p()(r,t().proxySettings)||e({proxySettings:r})}})}))(...e)})),o.x),x=()=>C.getState()},87662:(e,t,r)=>{r.d(t,{X:()=>o});let o=30},89626:(e,t,r)=>{r.r(t),r.d(t,{default:()=>R});var o=r(28802),n=r(28573),s=r(11577),i=r(31021),a=r.n(i),c=r(83034),l=r(59121),d=r(42379),p=r(38128),h=r(1824),g=r(91346),y=r(30179),u=r(32092),S=r(45541),f=r(88990),w=r(78397),v=r(64811),m=r(17869),C=r(33145),x=r(27697),k=r(98603),A=r(40318);let P=(0,c.memo)(()=>{let{t:e}=(0,l.Bd)("setting"),t=(0,x.Zp)();return(0,o.Y)(C.A,{center:(0,o.Y)(C.A.Title,{title:e("header.session")}),onBackClick:()=>t(-1),right:(0,o.Y)(A.A,{}),showBackButton:!0,style:k.p})}),R=(0,c.memo)(()=>{let{t:e}=(0,l.Bd)("setting"),[t,r]=(0,c.useState)(w.iL.Prompt),i=(0,s.DP)(),C=(0,h.e)(),[x,k,A]=(0,v.B)(e=>[e.activeId,e.updateSessionMeta,m.G.currentAgentTitle(e)]),[R]=(0,S.o)(e=>[e.updateAgentConfig]),b=(0,S.o)(f.e.currentAgentConfig,a()),E=(0,v.B)(m.G.currentAgentMeta,a()),{isLoading:I}=(0,u.H)();return(0,o.FD)(d.A,{header:(0,o.Y)(P,{}),children:[(0,o.Y)(p.A,{title:e("header.sessionWithName",{name:A})}),(0,o.Y)(n.A,{activeKey:t,compact:!0,items:C,onChange:e=>r(e),style:{borderBottom:`1px solid ${i.colorBorderSecondary}`}}),(0,o.Y)(g.A,{config:b,id:x,loading:I,meta:E,onConfigChange:R,onMetaChange:k,tab:t}),(0,o.Y)(y.A,{})]})})},90396:(e,t,r)=>{r.d(t,{x:()=>s});var o=r(14343);class n{constructor(){this.getProxySettings=async()=>(0,o.dispatch)("getProxySettings"),this.setSettings=async e=>(0,o.dispatch)("setProxySettings",e),this.getDesktopHotkeys=async()=>(0,o.dispatch)("getShortcutsConfig"),this.updateDesktopHotkey=async(e,t)=>(0,o.dispatch)("updateShortcutConfig",{accelerator:t,id:e}),this.testProxyConnection=async e=>(0,o.dispatch)("testProxyConnection",e),this.testProxyConfig=async(e,t)=>(0,o.dispatch)("testProxyConfig",{config:e,testUrl:t})}}let s=new n},98603:(e,t,r)=>{r.d(t,{p:()=>o});let o={position:"sticky",top:0,width:"100%",zIndex:100}}}]);