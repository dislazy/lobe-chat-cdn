"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[55269],{55269:(e,l,o)=>{o.r(l),o.d(l,{default:()=>ec});var a,i=o(28802),r=o(29703),t=o(89026),n=o(28573),d=o(83034),c=o(59121),s=o(80457),h=o(20549),m=o(15447),u=o(43588),p=o(42507),g=o(57696),b=o(49935),y=o(52851),v=o(26731),x=o(64811),A=o(17869),Y=o(47621),k=o(15095),F=o(67072),w=o(38471),N=o(82302),M=o(95891),z=o(22880),f=o(45541),S=o(88990),D=o(62016),T=o(80239),C=o(67393),B=o(17068),R=o(71171);let P=(0,d.memo)(()=>{let e=(0,B.L)(R.fA.mainDisplayChatIDs);return(0,i.Y)(s.Flexbox,{height:"100%",style:{paddingTop:24,position:"relative"},width:"100%",children:e.map((e,l)=>(0,i.Y)(C.A,{id:e,index:l},e))})});var W=o(11577),$=o(45628);let _=(0,W.rU)(({css:e,token:l,cx:o},a)=>({background:e`
    padding: 24px;

    background-color: ${l.colorBgLayout};
    background-image: url(${(0,$.b8)("screenshot_background.webp")});
    background-position: center;
    background-size: 120% 120%;
  `,container:o(a&&e`
        overflow: hidden;
        border: 2px solid ${l.colorBorder};
        border-radius: ${l.borderRadiusLG}px;
      `,e`
      background: ${l.colorBgLayout};
    `),footer:e`
    padding: 16px;
    border-block-start: 1px solid ${l.colorBorder};
  `,header:e`
    margin-block-end: -24px;
    padding: 16px;
    border-block-end: 1px solid ${l.colorBorder};
    background: ${l.colorBgContainer};
  `,role:e`
    margin-block-start: 12px;
    padding-block-start: 12px;
    border-block-start: 1px dashed ${l.colorBorderSecondary};
    opacity: 0.75;

    * {
      font-size: 12px !important;
    }
  `,url:e`
    color: ${l.colorTextDescription};
  `})),V=(0,d.memo)(({title:e,withSystemRole:l,withBackground:o,withFooter:a,widthMode:r})=>{let[t,n,d]=(0,f.o)(e=>[S.e.currentAgentModel(e),S.e.displayableAgentPlugins(e),S.e.currentAgentSystemRole(e)]),[h,m,u,p]=(0,x.B)(e=>[D.z.isInboxSession(e),A.G.currentAgentDescription(e),A.G.currentAgentAvatar(e),A.G.currentAgentBackgroundColor(e)]),{t:g}=(0,c.Bd)("chat"),{styles:b}=_(o),{styles:y}=(0,Y.H)(r),v=h?g("inbox.title"):e,C=h?g("inbox.desc"):m;return(0,i.Y)("div",{className:y.preview,children:(0,i.Y)("div",{className:o?b.background:void 0,id:"preview",children:(0,i.FD)(s.Flexbox,{className:b.container,gap:16,children:[(0,i.FD)("div",{className:b.header,children:[(0,i.FD)(s.Flexbox,{align:"flex-start",gap:12,horizontal:!0,children:[(0,i.Y)(F.A,{avatar:u,background:p,size:40,title:e}),(0,i.Y)(N.A,{desc:C,tag:(0,i.FD)(s.Flexbox,{gap:4,horizontal:!0,children:[(0,i.Y)(k.A,{model:t}),n?.length>0&&(0,i.Y)(z.A,{plugins:n})]}),title:v})]}),l&&d&&(0,i.Y)("div",{className:b.role,children:(0,i.Y)(w.A,{variant:"chat",children:d})})]}),(0,i.Y)(P,{}),a?(0,i.FD)(s.Flexbox,{align:"center",className:b.footer,gap:4,children:[(0,i.Y)(M.d,{type:"combine"}),(0,i.Y)("div",{className:b.url,children:T.TB})]}):(0,i.Y)("div",{})]})})})});var H=o(42901);let K={imageType:v.yj.JPG,widthMode:H.E.Wide,withBackground:!0,withFooter:!0,withPluginInfo:!1,withSystemRole:!1},L=(0,d.memo)(()=>{let e=(0,x.B)(A.G.currentAgentTitle),[l,o]=(0,d.useState)(K),{t:a}=(0,c.Bd)(["chat","common"]),{styles:r}=(0,Y.I)(),{loading:n,onDownload:k,title:F}=(0,v.aO)({imageType:l.imageType,title:e}),{loading:w,onCopy:N}=(0,y.g)(),M=[{label:a("shareModal.widthMode.wide"),value:H.E.Wide},{label:a("shareModal.widthMode.narrow"),value:H.E.Narrow}],z=[{children:(0,i.Y)(t.A,{options:M}),label:a("shareModal.widthMode.label"),layout:"horizontal",minWidth:void 0,name:"widthMode"},{children:(0,i.Y)(p.A,{}),label:a("shareModal.withSystemRole"),layout:"horizontal",minWidth:void 0,name:"withSystemRole",valuePropName:"checked"},{children:(0,i.Y)(p.A,{}),label:a("shareModal.withBackground"),layout:"horizontal",minWidth:void 0,name:"withBackground",valuePropName:"checked"},{children:(0,i.Y)(p.A,{}),label:a("shareModal.withFooter"),layout:"horizontal",minWidth:void 0,name:"withFooter",valuePropName:"checked"},{children:(0,i.Y)(t.A,{options:v.OM}),label:a("shareModal.imageType"),layout:"horizontal",minWidth:void 0,name:"imageType"}],f=(0,h.a)(),S=(0,i.FD)(i.FK,{children:[(0,i.Y)(m.A,{block:!0,icon:g.A,loading:w,onClick:()=>N(),size:f?void 0:"large",type:"primary",children:a("copy",{ns:"common"})}),(0,i.Y)(m.A,{block:!0,loading:n,onClick:k,size:f?void 0:"large",children:a("shareModal.download")})]});return(0,i.FD)(i.FK,{children:[(0,i.FD)(s.Flexbox,{className:r.body,gap:16,horizontal:!f,children:[(0,i.Y)(V,{title:F,...l}),(0,i.FD)(s.Flexbox,{className:r.sidebar,gap:12,children:[(0,i.Y)(u.Ay,{initialValues:K,items:z,itemsType:"flat",onValuesChange:(e,l)=>o(l),...b.pC}),!f&&S]})]}),f&&(0,i.Y)(s.Flexbox,{className:r.footer,gap:8,horizontal:!0,children:S})]})});var E=o(74551),G=o(32901),I=o(47690),O=o(58244),j=o(31021),J=o.n(j),U=o(13082),q=o(11439),Q=o(91888);let X=(0,d.memo)(({content:e})=>{let{styles:l}=(0,Y.H)();return(0,i.Y)("div",{className:l.preview,style:{padding:16},children:(0,i.Y)(Q.A,{language:"json",variant:"borderless",wrap:!0,children:e})})});var Z=o(19530);let ee={includeTool:!0,withSystemRole:!0},el=(0,d.memo)(()=>{let[e,l]=(0,d.useState)(ee),{t:o}=(0,c.Bd)(["chat","common"]),{styles:a}=(0,Y.I)(),{message:r}=O.A.useApp(),t=[{children:(0,i.Y)(p.A,{}),label:o("shareModal.withSystemRole"),layout:"horizontal",minWidth:void 0,name:"withSystemRole",valuePropName:"checked"},{children:(0,i.Y)(p.A,{}),label:o("shareModal.includeTool"),layout:"horizontal",minWidth:void 0,name:"includeTool",valuePropName:"checked"}],n=(0,f.o)(S.e.currentAgentSystemRole),b=(0,B.L)(U.E1.activeDbMessages,J()),y=JSON.stringify((({messages:e,withSystemRole:l,includeTool:o,systemRole:a})=>{let i=e.filter(e=>e.content!==Z.VH).filter(e=>!!o||"tool"!==e.role).map(e=>({content:e.content.trim(),role:e.role,tool_call_id:o&&e.tool_call_id?e.tool_call_id:void 0,tools:o&&e.tools?e.tools:void 0}));return l&&a?[{content:a,role:"system"},...i]:i})({...e,messages:b,systemRole:n}),null,2),v=(0,B.L)(q.e.currentActiveTopic,J()),x=v?.title||o("shareModal.exportTitle"),A=(0,h.a)(),k=(0,i.FD)(i.FK,{children:[(0,i.Y)(m.A,{block:!0,icon:g.A,onClick:async()=>{await (0,I.l)(y),r.success(o("copySuccess",{defaultValue:"Copy Success",ns:"common"}))},size:A?void 0:"large",type:"primary",children:o("copy",{ns:"common"})}),(0,i.Y)(m.A,{block:!0,onClick:()=>{(0,G.HP)(y,`${x}.json`)},size:A?void 0:"large",children:o("shareModal.downloadFile")})]});return(0,i.FD)(i.FK,{children:[(0,i.FD)(s.Flexbox,{className:a.body,gap:16,horizontal:!A,children:[(0,i.Y)(X,{content:y}),(0,i.FD)(s.Flexbox,{className:a.sidebar,gap:12,children:[(0,i.Y)(u.Ay,{initialValues:ee,items:t,itemsType:"flat",onValuesChange:(e,o)=>l(o),...E.pC}),!A&&k]})]}),A&&(0,i.Y)(s.Flexbox,{className:a.footer,gap:8,horizontal:!0,children:k})]})});var eo=o(49460),ea=o(91804);let ei=(0,d.memo)(({content:e})=>{let{styles:l}=(0,Y.H)(),o=(0,h.a)();return(0,i.Y)("div",{className:l.preview,style:{padding:12},children:(0,i.Y)(w.A,{variant:o?"chat":void 0,children:e})})});var er=o(72327);let et={includeTool:!0,includeUser:!0,withRole:!0,withSystemRole:!1},en=(0,d.memo)(()=>{let[e,l]=(0,d.useState)(et),{t:o}=(0,c.Bd)(["chat","common"]),{styles:a}=(0,Y.I)(),{message:r}=O.A.useApp(),t=[{children:(0,i.Y)(p.A,{}),label:o("shareModal.withSystemRole"),layout:"horizontal",minWidth:void 0,name:"withSystemRole",valuePropName:"checked"},{children:(0,i.Y)(p.A,{}),label:o("shareModal.withRole"),layout:"horizontal",minWidth:void 0,name:"withRole",valuePropName:"checked"},{children:(0,i.Y)(p.A,{}),label:o("shareModal.includeUser"),layout:"horizontal",minWidth:void 0,name:"includeUser",valuePropName:"checked"},{children:(0,i.Y)(p.A,{}),label:o("shareModal.includeTool"),layout:"horizontal",minWidth:void 0,name:"includeTool",valuePropName:"checked"}],[n]=(0,f.o)(e=>[S.e.currentAgentSystemRole(e)]),b=(0,B.L)(ea._1.activeDisplayMessages,J()),y=(0,B.L)(q.e.currentActiveTopic,J()),v=y?.title||o("shareModal.exportTitle"),x=(0,er.H)({...e,messages:b,systemRole:n,title:v}).replaceAll("\n\n\n","\n"),A=(0,h.a)(),k=(0,i.FD)(i.FK,{children:[(0,i.Y)(m.A,{block:!0,icon:g.A,onClick:async()=>{await (0,I.l)(x),r.success(o("copySuccess",{defaultValue:"Copy Success",ns:"common"}))},size:A?void 0:"large",type:"primary",children:o("copy",{ns:"common"})}),(0,i.Y)(m.A,{block:!0,onClick:()=>{(0,G.HP)(x,`${v}.md`)},size:A?void 0:"large",children:o("shareModal.downloadFile")})]});return(0,i.FD)(i.FK,{children:[(0,i.FD)(s.Flexbox,{className:a.body,gap:16,horizontal:!A,children:[(0,i.Y)(ei,{content:x}),(0,i.FD)(s.Flexbox,{className:a.sidebar,gap:12,children:[(0,i.Y)(u.Ay,{initialValues:et,items:t,itemsType:"flat",onValuesChange:(e,o)=>l(o),...E.pC}),!A&&k]})]}),A&&(0,i.Y)(s.Flexbox,{className:a.footer,gap:8,horizontal:!0,children:k})]})});var ed=((a=ed||{}).JSON="json",a.PDF="pdf",a.Screenshot="screenshot",a.Text="text",a);let ec=(0,d.memo)(({onCancel:e,open:l})=>{let[o,a]=(0,d.useState)("screenshot"),{t:m}=(0,c.Bd)("chat"),u=(0,h.a)(),p=(0,d.useMemo)(()=>[{children:(0,i.Y)(L,{mobile:u}),key:"screenshot",label:m("shareModal.screenshot")},{children:(0,i.Y)(en,{}),key:"text",label:m("shareModal.text")},{children:(0,i.Y)(eo.A,{}),key:"pdf",label:m("shareModal.pdf")},{children:(0,i.Y)(el,{}),key:"json",label:"JSON"}],[u,m]);return(0,i.Y)(r.A,{allowFullscreen:!0,centered:!1,destroyOnHidden:!0,footer:null,onCancel:e,open:l,title:m("share",{ns:"common"}),width:1440,children:(0,i.FD)(s.Flexbox,{gap:u?8:24,children:[(0,i.Y)(t.A,{block:!0,onChange:e=>a(e),options:p.map(e=>({label:e?.label,value:e?.key})),style:{width:"100%"},value:o,variant:"filled"}),(0,i.Y)(n.A,{activeKey:o,indicator:{align:"center",size:e=>e-20},items:p,onChange:e=>a(e),renderTabBar:()=>(0,i.Y)(i.FK,{})})]})})})}}]);