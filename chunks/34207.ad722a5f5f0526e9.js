"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[34207],{8834:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(83034),a=r(24433),i=r(80851);let s=function(e,t){var r=(0,a.A)(e),s=(0,n.useRef)(null),o=(0,n.useCallback)(function(){s.current&&clearTimeout(s.current)},[]);return(0,n.useEffect)(function(){if((0,i.Et)(t)&&!(t<0))return s.current=setTimeout(r,t),o},[t]),o}},24433:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(83034),a=r(80851),i=r(82464);let s=function(e){i.A&&!(0,a.Tn)(e)&&console.error("useMemoizedFn expected parameter is a function, got ".concat(typeof e));var t=(0,n.useRef)(e);t.current=(0,n.useMemo)(function(){return e},[e]);var r=(0,n.useRef)(void 0);return r.current||(r.current=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.current.apply(this,e)}),r.current}},29914:(e,t,r)=>{let n,a,i;r.d(t,{Ay:()=>o,Ew:()=>a,iU:()=>n,yl:()=>i});var s=r(58244);let o=(0,r(83034).memo)(()=>{let e=s.A.useApp();return n=e.message,i=e.modal,a=e.notification,null})},34207:(e,t,r)=>{r.d(t,{loginRequired:()=>d});var n=r(28802),a=r(51717),i=r(96987),s=r(29914),o=r(8834),u=r(83034),l=r(59121),c=r(38759);let f=(0,u.memo)(({timeout:e=2e3})=>{let t=(0,c.k)(e=>e.openLogin),{t:r}=(0,l.Bd)("error");return(0,o.A)(()=>{t()},e),(0,n.Y)("div",{style:{cursor:"pointer",fontSize:12},children:r("loginRequired.desc")})}),d={redirect:({timeout:e=2e3}={})=>{s.Ew.error({description:(0,n.Y)(f,{timeout:e}),duration:e/1e3,icon:(0,n.Y)(a.A,{emoji:"\uD83E\uDEE1",size:24}),message:(0,i.t)("loginRequired.title",{ns:"error"}),showProgress:!0,type:"warning"})}}},38759:(e,t,r)=>{r.d(t,{c:()=>x,k:()=>C});var n=r(14308),a=r(50786),i=r(23993),s=r(41734),o=r(89872);let u={preference:o.I},l={...{defaultSettings:r(74551).a$,settings:{}},...u,...{},...{isOnboard:!1,isShowPWAGuide:!1,isUserCanEnableTrace:!1,isUserHasConversation:!1,isUserStateInit:!1}};var c=r(96773),f=r(70674),d=r(64911),p=r(85366),m=r(46265),g=r(55582),y=r(67095),b=r(61497),S=r(71457);let v=(0,b.K)("common"),h="initUserState",A=(0,b.K)("preference");var w=r(31021),O=r.n(w),j=r(19530),U=r(45628);class P{constructor(){this.createShareSettingsUrl=e=>`/?${U.N}=${encodeURI(JSON.stringify(e))}`,this.decodeShareSettings=e=>{try{return{data:JSON.parse(e)}}catch(e){return{message:JSON.stringify(e)}}}}}let I=new P;var E=r(34743),k=r(1866),N=r(28074);let T=(0,s.t)("user"),C=(0,i.h)()((0,n.eh)(T((...e)=>({...l,...((e,t)=>({addToolToAllowList:async e=>{let r=t().settings.tool?.humanIntervention?.allowList||[];r.includes(e)||await t().setSettings({tool:{humanIntervention:{allowList:[...r,e]}}})},importAppSettings:async e=>{let{setSettings:r}=t();await r(e)},importUrlShareSettings:async e=>{if(e){let r=I.decodeShareSettings(e);!r?.message&&r?.data&&await t().setSettings(r.data)}},internal_createSignal:()=>{let r=t().updateSettingsSignal;r&&!r.signal.aborted&&r.abort(j.ve);let n=new AbortController;return e({updateSettingsSignal:n},!1,"signalForUpdateSettings"),n},resetSettings:async()=>{await g.W.resetUserSettings(),await t().refreshUserState()},setSettings:async r=>{let n,{settings:a,defaultSettings:i}=t(),s=(0,y.h)(a,r);if(O()(a,s))return;let o=(n=(e,t)=>(0,E.A)(e,(e,r,a)=>{(0,k.A)(r)&&(0,k.A)(t[a])?O()(r,t[a])||(e[a]=r):O()(r,t[a])||(e[a]=(0,N.A)(r)&&(0,N.A)(t[a])?n(r,t[a]):r)}))(s,i);e({settings:o},!1,"optimistic_updateSettings");let u=t().internal_createSignal();await g.W.updateUserSettings(o,u.signal),await t().refreshUserState()},updateDefaultAgent:async e=>{await t().setSettings({defaultAgent:e})},updateGeneralConfig:async e=>{await t().setSettings({general:e})},updateHumanIntervention:async e=>{let r=t().settings.tool?.humanIntervention||{};await t().setSettings({tool:{humanIntervention:{...r,...e}}})},updateKeyVaults:async e=>{await t().setSettings({keyVaults:e})},updateSystemAgent:async(e,r)=>{await t().setSettings({systemAgent:{[e]:{...r}}})}}))(...e),...((e,t)=>({updateGuideState:async e=>{let{updatePreference:r}=t(),n=(0,y.h)(t().preference.guide,e);await r({guide:n})},updateLab:async e=>{let{updatePreference:r}=t(),n=(0,y.h)(t().preference.lab,e);await r({lab:n},A("updateLab"))},updatePreference:async(r,n)=>{let a=(0,y.h)(t().preference,r);e({preference:a},!1,n||A("updatePreference")),await g.W.updatePreference(a)}}))(...e),...((e,t)=>({enableAuth:()=>c.S4,logout:async()=>{if(c.Nd)return void t().clerkSignOut?.({redirectUrl:location.toString()});if(c.J_){let{signOut:e}=await r.e(4975).then(r.bind(r,4975));e()}},openLogin:async()=>{if(c.Nd){let e=location.toString();t().clerkSignIn?.({fallbackRedirectUrl:e,signUpForceRedirectUrl:e,signUpUrl:"/signup"});return}if(c.J_){let{signIn:e}=await r.e(4975).then(r.bind(r,4975)),n=t()?.oAuthSSOProviders;if(n&&1===n.length)return void e(n[0]);e()}}}))(...e),...((e,t)=>({refreshUserState:async()=>{await (0,d.j)(h)},updateAvatar:async e=>{await g.W.updateAvatar(e),await t().refreshUserState()},updateKeyVaultConfig:async(e,r)=>{await t().setSettings({keyVaults:{[e]:r}})},useCheckTrace:e=>(0,p.Ay)(e?"checkTrace":null,()=>"boolean"==typeof S.U.userAllowTrace(t())?Promise.resolve(!1):Promise.resolve(t().isUserCanEnableTrace),{revalidateOnFocus:!1}),useInitUserState:(r,n,a)=>(0,m.Ju)(r?h:null,()=>g.W.getUserState(),{onError:e=>{a?.onError?.(e)},onSuccess:r=>{if(a?.onSuccess?.(r),r){let a={defaultAgent:n.defaultAgent,image:n.image,systemAgent:n.systemAgent},i=(0,y.h)(t().defaultSettings,a),s=0===Object.keys(r.preference||{}).length?o.I:r.preference,u=r.avatar||r.userId?(0,y.h)(t().user,{avatar:r.avatar,email:r.email,firstName:r.firstName,fullName:r.fullName,id:r.userId,latestName:r.lastName,username:r.username}):t().user;e({defaultSettings:i,isOnboard:r.isOnboard,isShowPWAGuide:r.canEnablePWAGuide,isUserCanEnableTrace:r.canEnableTrace,isUserHasConversation:r.hasConversation,isUserStateInit:!0,preference:s,settings:r.settings||{},subscriptionPlan:r.subscriptionPlan,user:u},!1,v("initUserState"));let l=(0,f.wZ)();l?.identify(r.userId||"",{email:r.email,firstName:r.firstName,lastName:r.lastName,username:r.username})}}})}))(...e)}))),a.x),x=()=>C.getState()},51717:(e,t,r)=>{r.d(t,{A:()=>v});var n,a=r(83034),i=r(20480),s=r(4438),o=r(58910),u=(0,r(11577).rU)(function(e){var t,r;return{container:(0,e.css)(n||(t=["\n      position: relative;\n      line-height: 1;\n      text-align: center;\n    "],r||(r=t.slice(0)),n=Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(r)}}))))}});function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function c(e){return((function(e){if(Array.isArray(e))return l(e)})(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return l(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map(function(e){var t;return null==e||null==(t=e.codePointAt(0))?void 0:t.toString(16)}).join("-")}var f=function(e,t){var r,n=["anim","3d"].includes(t)?"webp":"svg";switch(t){case"raw":return null;case"anim":return{path:"assets/".concat(c(e),".").concat(n),pkg:(r=c(e).split("-")[0])<"1f469"?"@lobehub/fluent-emoji-anim-1":r>="1f469"&&r<"1f620"?"@lobehub/fluent-emoji-anim-2":r>="1f620"&&r<"1f9a0"?"@lobehub/fluent-emoji-anim-3":"@lobehub/fluent-emoji-anim-4",version:"latest"};case"3d":return{path:"assets/".concat(c(e),".").concat(n),pkg:"@lobehub/fluent-emoji-3d",version:"latest"};case"flat":return{path:"assets/".concat(c(e),".").concat(n),pkg:"@lobehub/fluent-emoji-flat",version:"latest"};case"modern":return{path:"assets/".concat(c(e),".").concat(n),pkg:"@lobehub/fluent-emoji-modern",version:"latest"};case"mono":return{path:"assets/".concat(c(e),".").concat(n),pkg:"@lobehub/fluent-emoji-mono",version:"latest"}}},d=r(54898);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var m=["emoji","className","style","type","size","unoptimized","ref"];function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach(function(t){var n,a,i;n=e,a=t,i=r[t],(a=function(e){var t=function(e,t){if("object"!=p(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=p(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==p(t)?t:String(t)}(a))in n?Object.defineProperty(n,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[a]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var S=(0,a.memo)(function(e){var t,r=e.emoji,n=e.className,l=e.style,c=e.type,p=void 0===c?"3d":c,g=e.size,S=void 0===g?40:g,v=e.unoptimized,h=e.ref,A=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,m),w=function(e){if(Array.isArray(e))return e}(t=(0,a.useState)(!1))||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i,s,o=[],u=!0,l=!1;try{i=(r=r.call(e)).next,!1;for(;!(u=(n=i.call(r)).done)&&(o.push(n.value),2!==o.length);u=!0);}catch(e){l=!0,a=e}finally{try{if(!u&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(l)throw a}}return o}}(t,2)||function(e,t){if(e){if("string"==typeof e)return b(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b(e,2)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),O=w[0],j=w[1],U=(0,s.BV)(),P=u(),I=P.cx,E=P.styles,k=(0,a.useMemo)(function(){return f(r,p)},[p,r]);return"raw"===p||!k||O?(0,d.jsx)(i.default,y(y({className:I(E.container,n),flex:"none",height:S,ref:h,role:"img",style:y({fontSize:.9*S},l),width:S},A),{},{children:r})):(0,d.jsx)(o.A,y({alt:r,className:n,height:S,loading:"lazy",onError:function(){return j(!0)},ref:h,src:U(k),style:y({flex:"none"},l),unoptimized:v,width:S},A))});S.displayName="FluentEmoji";let v=S},55582:(e,t,r)=>{r.d(t,{W:()=>i});var n=r(77605);class a{constructor(){this.getUserRegistrationDuration=async()=>n.du.user.getUserRegistrationDuration.query(),this.getUserState=async()=>n.du.user.getUserState.query(),this.getUserSSOProviders=async()=>n.du.user.getUserSSOProviders.query(),this.unlinkSSOProvider=async(e,t)=>n.du.user.unlinkSSOProvider.mutate({provider:e,providerAccountId:t}),this.makeUserOnboarded=async()=>n.du.user.makeUserOnboarded.mutate(),this.updateAvatar=async e=>n.du.user.updateAvatar.mutate(e),this.updatePreference=async e=>n.du.user.updatePreference.mutate(e),this.updateGuide=async e=>n.du.user.updateGuide.mutate(e),this.updateUserSettings=async(e,t)=>n.du.user.updateSettings.mutate(e,{signal:t}),this.resetUserSettings=async()=>n.du.user.resetSettings.mutate()}}let i=new a},58244:(e,t,r)=>{r.d(t,{A:()=>m});var n=r(83034),a=r(52762),i=r.n(a),s=r(34285),o=r(67863),u=r(25095),l=r(4626),c=r(21797),f=r(4532);let d=(0,r(94348).OF)("App",e=>{let{componentCls:t,colorText:r,fontSize:n,lineHeight:a,fontFamily:i}=e;return{[t]:{color:r,fontSize:n,lineHeight:a,fontFamily:i,[`&${t}-rtl`]:{direction:"rtl"}}}},()=>({})),p=e=>{let{prefixCls:t,children:r,className:a,rootClassName:p,message:m,notification:g,style:y,component:b="div"}=e,{direction:S,getPrefixCls:v}=(0,n.useContext)(o.QO),h=v("app",t),[A,w,O]=d(h),j=i()(w,h,a,p,O,{[`${h}-rtl`]:"rtl"===S}),U=(0,n.useContext)(f.B),P=n.useMemo(()=>({message:Object.assign(Object.assign({},U.message),m),notification:Object.assign(Object.assign({},U.notification),g)}),[m,g,U.message,U.notification]),[I,E]=(0,u.A)(P.message),[k,N]=(0,c.A)(P.notification),[T,C]=(0,l.A)(),x=n.useMemo(()=>({message:I,notification:k,modal:T}),[I,k,T]);(0,s.rJ)("App")(!(O&&!1===b),"usage","When using cssVar, ensure `component` is assigned a valid React component string.");let z=!1===b?n.Fragment:b;return A(n.createElement(f.A.Provider,{value:x},n.createElement(f.B.Provider,{value:P},n.createElement(z,Object.assign({},!1===b?void 0:{className:j,style:y}),C,E,N,r))))};p.useApp=()=>n.useContext(f.A);let m=p},71457:(e,t,r)=>{r.d(t,{U:()=>a});var n=r(74551);let a={hideSettingsMoveGuide:e=>e.preference.guide?.moveSettingsToAvatar,hideSyncAlert:e=>e.preference.hideSyncAlert,isPreferenceInit:e=>e.isUserStateInit,shouldTriggerFileInKnowledgeBaseTip:e=>"boolean"!=typeof e.preference.guide?.moveSettingsToAvatar,showUploadFileInKnowledgeBaseTip:e=>e.preference.guide?.uploadFileInKnowledgeBase,topicDisplayMode:e=>e.preference.topicDisplayMode||n.I4.topicDisplayMode,useCmdEnterToSend:e=>e.preference.useCmdEnterToSend||!1,userAllowTrace:e=>e.preference.telemetry}},80851:(e,t,r)=>{r.d(t,{Et:()=>a,Tn:()=>n});var n=function(e){return"function"==typeof e},a=function(e){return"number"==typeof e}},82464:(e,t,r)=>{r.d(t,{A:()=>n});let n=!1}}]);