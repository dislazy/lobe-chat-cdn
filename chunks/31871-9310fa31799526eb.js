"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[31871],{5750:(e,t,i)=>{i.d(t,{F:()=>a});var r=i(77605);class o{constructor(){this.createAiProvider=async e=>r.du.aiProvider.createAiProvider.mutate(e),this.getAiProviderList=async()=>r.du.aiProvider.getAiProviderList.query(),this.getAiProviderById=async e=>r.du.aiProvider.getAiProviderById.query({id:e}),this.toggleProviderEnabled=async(e,t)=>r.du.aiProvider.toggleProviderEnabled.mutate({enabled:t,id:e}),this.updateAiProvider=async(e,t)=>r.du.aiProvider.updateAiProvider.mutate({id:e,value:t}),this.updateAiProviderConfig=async(e,t)=>r.du.aiProvider.updateAiProviderConfig.mutate({id:e,value:t}),this.updateAiProviderOrder=async e=>r.du.aiProvider.updateAiProviderOrder.mutate({sortMap:e}),this.deleteAiProvider=async e=>r.du.aiProvider.removeAiProvider.mutate({id:e}),this.getAiProviderRuntimeState=async e=>r.du.aiProvider.getAiProviderRuntimeState.query({isLogin:e})}}let a=new o},15361:(e,t,i)=>{i.d(t,{cA:()=>a,P4:()=>m,vB:()=>r,ju:()=>o,K7:()=>n,qY:()=>s,e0:()=>l,ux:()=>d,aj:()=>b,fY:()=>M,y_:()=>_,o9:()=>$,O9:()=>k,Sy:()=>A,T:()=>g,JN:()=>c,FM:()=>p,rj:()=>u,jY:()=>w,fQ:()=>h,po:()=>v,X6:()=>P});let r=e=>({messages:[{content:"ä½ æ˜¯ä¸€åç²¾é€šå…¨ä¸–ç•Œè¯­è¨€çš„è¯­è¨€ä¸“å®¶ï¼Œä½ éœ€è¦è¯†åˆ«ç”¨æˆ·è¾“å…¥çš„å†…å®¹ï¼Œä»¥å›½é™…æ ‡å‡† locale è¿›è¡Œè¾“å‡º",role:"system"},{content:"{ä½ å¥½}",role:"user"},{content:"zh-CN",role:"assistant"},{content:"{hello}",role:"user"},{content:"en-US",role:"assistant"},{content:`{${e}}`,role:"user"}]}),o=e=>({messages:[{content:`You are an emoji expert who selects the most appropriate emoji to represent concepts, emotions, or topics.

Rules:
- Output ONLY a single emoji (1-2 characters maximum)
- Focus on the CONTENT meaning, not the language it's written in
- Choose an emoji that best represents the core topic, activity, or subject matter
- Prioritize topic-specific emojis over generic emotion emojis (e.g., for sports, use ðŸƒ instead of ðŸ˜…)
- For work/projects, use work-related emojis (ðŸ’¼, ðŸš€, ðŸ’ª) not cultural symbols
- For pure emotions without specific topics, use face emojis (happy: ðŸŽ‰, sad: ðŸ˜¢, thinking: ðŸ¤”)
- For activities or subjects, use object or symbol emojis that represent the main topic
- No explanations or additional text`,role:"system"},{content:"I am a copywriting master who helps name design and art works with literary depth",role:"user"},{content:"âœ’ï¸",role:"assistant"},{content:"I am a code wizard who converts JavaScript code to TypeScript",role:"user"},{content:"\uD83E\uDDD9â€â™‚ï¸",role:"assistant"},{content:"I just got a promotion at work",role:"user"},{content:"\uD83C\uDF89",role:"assistant"},{content:"I am a business plan expert who helps with startup strategies and marketing",role:"user"},{content:"\uD83D\uDE80",role:"assistant"},{content:e,role:"user"}]}),a="Given the following conversation and a follow-up question, rephrase the follow up question to be a standalone question, in its original language. Keep as much details as possible from previous messages. Keep entity names and all.",n=(e,t,i=a)=>({messages:[{content:`${i}
<chatHistory>
${t.join("\n")}
</chatHistory>
`,role:"system"},{content:`Follow Up Input: ${e}, it's standalone query:`,role:"user"}]}),s=(e,t)=>({messages:[{content:`ä½ æ˜¯ä¸€åæ“…é•¿èµ·åçš„èµ·åå¤§å¸ˆï¼Œåå­—éœ€è¦æœ‰æ–‡å­¦å†…æ¶µï¼Œæ³¨é‡ç²¾ç‚¼å’Œèµ‹å­æ„å¢ƒï¼Œä½ éœ€è¦å°†ç”¨æˆ·çš„æè¿°æ€»ç»“ä¸º 10 ä¸ªå­—ä»¥å†…çš„è§’è‰²ï¼Œå¹¶ç¿»è¯‘ä¸ºç›®æ ‡è¯­è¨€ã€‚æ ¼å¼è¦æ±‚å¦‚ä¸‹ï¼š
è¾“å…¥: {æ–‡æœ¬ä½œä¸ºJSONå¼•ç”¨å­—ç¬¦ä¸²} [locale]
è¾“å‡º: {è§’è‰²å}`,role:"system"},{content:`è¾“å…¥: {ä½ æ˜¯ä¸€åæ–‡æ¡ˆå¤§å¸ˆï¼Œå¸®æˆ‘ä¸ºä¸€äº›è®¾è®¡ / è‰ºæœ¯ä½œå“èµ·åï¼Œåå­—éœ€è¦æœ‰æ–‡å­¦å†…æ¶µï¼Œæ³¨é‡ç²¾ç‚¼å’Œèµ‹å­æ„å¢ƒï¼Œè¡¨è¾¾ä½œå“çš„æƒ…æ™¯æ°›å›½ï¼Œä½¿åç§°æ—¢ç®€æ´åˆå¯Œæœ‰è¯—æ„ã€‚} [zh-CN]`,role:"user"},{content:`è¾“å…¥: {ä½ æ˜¯ä¸€å UX Writerï¼Œæ“…é•¿å°†å¹³å¹³æ— å¥‡çš„æè¿°è½¬æ¢ä¸ºç²¾å¦™çš„è¡¨è¾¾ã€‚æŽ¥ä¸‹æ¥ç”¨æˆ·ä¼šè¾“å…¥ä¸€æ®µæ–‡æœ¬ï¼Œä½ éœ€è¦è½¬æˆæ›´åŠ æ£’çš„è¡¨è¿°æ–¹å¼ï¼Œé•¿åº¦ä¸è¶…è¿‡40ä¸ªå­—ã€‚} [ru-RU]`,role:"user"},{content:"Ð¢Ð²Ð¾Ñ€Ñ‡ÐµÑÐºÐ¸Ð¹ Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¾Ñ€ UX",role:"assistant"},{content:`è¾“å…¥: {ä½ æ˜¯ä¸€åå‰ç«¯ä»£ç ä¸“å®¶ï¼Œè¯·å°†ä¸‹é¢çš„ä»£ç è½¬æˆ tsï¼Œä¸è¦ä¿®æ”¹å®žçŽ°ã€‚å¦‚æžœåŽŸæœ¬ js ä¸­æ²¡æœ‰å®šä¹‰çš„å…¨å±€å˜é‡ï¼Œéœ€è¦è¡¥å…… declare çš„ç±»åž‹å£°æ˜Žã€‚} [en-US]`,role:"user"},{content:"TS Transformer",role:"assistant"},{content:`è¾“å…¥: {Improve my English language use by replacing basic A0-level expressions with more sophisticated, advanced-level phrases while maintaining the conversation's essence. Your responses should focus solely on corrections and enhancements, avoiding additional explanations.} [zh-CN]`,role:"user"},{content:"é‚®ä»¶ä¼˜åŒ–åŠ©ç†",role:"assistant"},{content:`è¾“å…¥: {${e}} [${t}]`,role:"user"}]}),l=(e,t)=>({messages:[{content:`ä½ æ˜¯ä¸€åæ“…é•¿æŠ€èƒ½æ€»ç»“çš„åŠ©ç†ï¼Œä½ éœ€è¦å°†ç”¨æˆ·çš„è¾“å…¥çš„å†…å®¹æ€»ç»“ä¸ºä¸€ä¸ªè§’è‰²æŠ€èƒ½ç®€ä»‹ï¼Œä¸è¶…è¿‡ 20 ä¸ªå­—ã€‚å†…å®¹éœ€è¦ç¡®ä¿ä¿¡æ¯æ¸…æ™°ã€é€»è¾‘æ¸…æ™°ï¼Œå¹¶æœ‰æ•ˆåœ°ä¼ è¾¾è§’è‰²çš„æŠ€èƒ½å’Œç»éªŒï¼Œéœ€è¦å¹¶ç¿»è¯‘ä¸ºç›®æ ‡è¯­è¨€:${t}ã€‚æ ¼å¼è¦æ±‚å¦‚ä¸‹ï¼š
è¾“å…¥: {æ–‡æœ¬ä½œä¸ºJSONå¼•ç”¨å­—ç¬¦ä¸²} [locale]
è¾“å‡º: {ç®€ä»‹}`,role:"system"},{content:`è¾“å…¥: {ä½ æ˜¯ä¸€åæ–‡æ¡ˆå¤§å¸ˆï¼Œå¸®æˆ‘ä¸ºä¸€äº›è®¾è®¡ / è‰ºæœ¯ä½œå“èµ·åï¼Œåå­—éœ€è¦æœ‰æ–‡å­¦å†…æ¶µï¼Œæ³¨é‡ç²¾ç‚¼å’Œèµ‹å­æ„å¢ƒï¼Œè¡¨è¾¾ä½œå“çš„æƒ…æ™¯æ°›å›½ï¼Œä½¿åç§°æ—¢ç®€æ´åˆå¯Œæœ‰è¯—æ„ã€‚} [zh-CN]`,role:"user"},{content:"æ“…é•¿æ–‡åˆ›è‰ºæœ¯ä½œå“èµ·å",role:"assistant"},{content:`è¾“å…¥: {ä½ æ˜¯ä¸€ååˆ›ä¸šè®¡åˆ’æ’°å†™ä¸“å®¶ï¼Œå¯ä»¥æä¾›åŒ…æ‹¬åˆ›æ„åç§°ã€ç®€çŸ­çš„æ ‡è¯­ã€ç›®æ ‡ç”¨æˆ·ç”»åƒã€ç”¨æˆ·ç—›ç‚¹ã€ä¸»è¦ä»·å€¼ä¸»å¼ ã€é”€å”®/è¥é”€æ¸ é“ã€æ”¶å…¥æµã€æˆæœ¬ç»“æž„ç­‰è®¡åˆ’ç”Ÿæˆã€‚} [en-US]`,role:"user"},{content:"Good at business plan writing and consulting",role:"assistant"},{content:`è¾“å…¥: {You are a frontend expert. Please convert the code below to TS without modifying the implementation. If there are global variables not defined in the original JS, you need to add type declarations using declare.} [zh-CN]`,role:"user"},{content:"æ“…é•¿ ts è½¬æ¢å’Œè¡¥å……ç±»åž‹å£°æ˜Ž",role:"assistant"},{content:`è¾“å…¥: {
ç”¨æˆ·æ­£å¸¸ä¹¦å†™é¢å‘å¼€å‘è€…çš„ API ç”¨æˆ·ä½¿ç”¨æ–‡æ¡£ã€‚ä½ éœ€è¦ä»Žç”¨æˆ·çš„è§†è§’æ¥æä¾›æ¯”è¾ƒæ˜“ç”¨æ˜“è¯»çš„æ–‡æ¡£å†…å®¹ã€‚

ä¸€ä¸ªæ ‡å‡†çš„ API æ–‡æ¡£ç¤ºä¾‹å¦‚ä¸‹ï¼š

\`\`\`markdown
---
title: useWatchPluginMessage
description: ç›‘å¬èŽ·å– LobeChat å‘è¿‡æ¥çš„æ’ä»¶æ¶ˆæ¯
nav: API
---

\`useWatchPluginMessage\` æ˜¯ Chat Plugin SDK å°è£…ä¸€ä¸ªçš„ React Hookï¼Œç”¨äºŽç›‘å¬ä»Ž LobeChat å‘è¿‡æ¥çš„æ’ä»¶æ¶ˆæ¯ã€‚
} [ru-RU]`,role:"user"},{content:"Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ð½Ð° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ Ñ…Ð¾Ñ€Ð¾ÑˆÐ¾ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ð¹ Ð¸ Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸ README Ð´Ð»Ñ GitHub Ñ Ñ‚Ð¾Ñ‡Ð½Ñ‹Ð¼Ð¸ Ñ‚ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼Ð¸ Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð¼Ð¸",role:"assistant"},{content:`è¾“å…¥: {ä½ æ˜¯ä¸€ååˆ›ä¸šè®¡åˆ’æ’°å†™ä¸“å®¶ï¼Œå¯ä»¥æä¾›åŒ…æ‹¬åˆ›æ„åç§°ã€ç®€çŸ­çš„æ ‡è¯­ã€ç›®æ ‡ç”¨æˆ·ç”»åƒã€ç”¨æˆ·ç—›ç‚¹ã€ä¸»è¦ä»·å€¼ä¸»å¼ ã€é”€å”®/è¥é”€æ¸ é“ã€æ”¶å…¥æµã€æˆæœ¬ç»“æž„ç­‰è®¡åˆ’ç”Ÿæˆã€‚} [zh-CN]`,role:"user"},{content:"æ“…é•¿åˆ›ä¸šè®¡åˆ’æ’°å†™ä¸Žå’¨è¯¢",role:"assistant"},{content:`è¾“å…¥: {${e}} [${t}]`,role:"user"}],temperature:0}),d=(e,t,i)=>{let r=e.map((e,t)=>`${t+1}. ${e}`).join("\n");return{messages:[{content:`ä½ æ˜¯ä¸€ä½èµ„æ·±çš„ AI è‰ºæœ¯åˆ›ä½œè€…å’Œè¯­è¨€å¤§å¸ˆã€‚ä½ éœ€è¦æ ¹æ®ç”¨æˆ·æä¾›çš„ AI ${t} prompt æ€»ç»“å‡ºä¸€ä¸ªæ ‡é¢˜ã€‚è¿™ä¸ªæ ‡é¢˜åº”ç®€æ´åœ°æè¿°åˆ›ä½œçš„æ ¸å¿ƒå†…å®¹ï¼Œå°†ç”¨äºŽæ ‡è¯†å’Œç®¡ç†è¯¥ç³»åˆ—ä½œå“ã€‚å­—æ•°éœ€æŽ§åˆ¶åœ¨10ä¸ªå­—ä»¥å†…ï¼Œä¸éœ€è¦åŒ…å«æ ‡ç‚¹ç¬¦å·ï¼Œè¾“å‡ºè¯­è¨€ä¸ºï¼š${i}ã€‚`,role:"system"},{content:`æç¤ºè¯ï¼š
${r}`,role:"user"}]}},u=e=>e.filter(e=>"supervisor"!==e.role).map(e=>{let t,i;return t="user"===e.role?"user":e.agentId||"assistant",i=e.targetId?` target="${e.targetId}"`:"",`<message author="${t}"${i}>${e.content}</message>`}).join("\n"),c=(e,t)=>e.filter(e=>"supervisor"!==e.role).map(e=>"system"===e.role?e:"user"===e.role?e.targetId&&e.targetId!==t?{...e,content:"***"}:e:"assistant"===e.role?e.targetId&&e.targetId!==t&&e.agentId!==t?{...e,content:"***"}:e:e),g=({imageList:e,fileList:t,videoList:i,addUrl:r=!0})=>{let o=(e||[]).length>0,a=(t||[]).length>0,n=(i||[]).length>0;if(!o&&!a&&!n)return"";let s=[o?0===e.length?"":`<images>
<images_docstring>here are user upload images you can refer to</images_docstring>
${e.map(e=>r?`<image name="${e.alt}" url="${e.url}"></image>`:`<image name="${e.alt}"></image>`).join("\n")}
</images>`.trim():"",a?0===t.length?"":`<files>
<files_docstring>here are user upload files you can refer to</files_docstring>
${t.map(e=>{let t;return t=e.content||"",r?`<file id="${e.id}" name="${e.name}" type="${e.fileType}" size="${e.size}" url="${e.url}">${t}</file>`:`<file id="${e.id}" name="${e.name}" type="${e.fileType}" size="${e.size}">${t}</file>`}).join("\n")}
</files>`.trim():"",n?((e,t=!0)=>0===e.length?"":`<videos>
<videos_docstring>here are user upload videos you can refer to</videos_docstring>
${e.map(e=>t?`<video name="${e.alt}" url="${e.url}"></video>`:`<video name="${e.alt}"></video>`).join("\n")}
</videos>`.trim())(i,r):""].filter(Boolean);return`<!-- SYSTEM CONTEXT (NOT PART OF USER QUERY) -->
<context.instruction>following part contains context information injected by the system. Please follow these instructions:

1. Always prioritize handling user-visible content.
2. the context is only required when user's queries rely on it.
</context.instruction>
<files_info>
${s.join("\n")}
</files_info>
<!-- END SYSTEM CONTEXT -->`.trim()},m=({baseSystemRole:e="",agentId:t,groupMembers:i,targetId:r,instruction:o})=>{let a=i&&0!==i.length?`<group_members>
${JSON.stringify(i,null,2)}
</group_members>`:"",n=i.find(e=>e.id===t)?.title||"Agent",s=[e,["Guidelines:","",...[`Stay in character as ${t} (${n})`,"Be concise and natural, behave like a real person","The group supervisor will decide whether to send it privately or publicly, so you just need to say the actuall content, even it's a DM to a specific member. Do not pretend you've sent it.","Be collaborative and build upon others' responses when appropriate","Keep your responses concise and relevant to the ongoing discussion"].map(e=>`- ${e}`)].join("\n")];a&&s.push(a);let l=o?`SUPERVISOR INSTRUCTION: ${o}`:"";return s.push(`Now it's your turn to respond. ${l} You are sending message to ${r||"the group publicly"}. Please respond as this agent would, considering the full conversation history provided above. Directly return the message content, no other text. You do not need add author name or anything else.`.trim()),s.filter(Boolean).join("\n\n").trim()},p={buildGroupChatSystemPrompt:m,buildSupervisorPrompt:({allowDM:e=!0,scene:t="productive",availableAgents:i,conversationHistory:r,todoList:o,systemPrompt:a,userName:n})=>{let s=[{id:"user",name:n||"User",role:"user"},...i.map(e=>({id:e.id,name:e.title||e.id,role:"assistant"}))].map(e=>`  <member id="${e.id}" name="${e.name}" />`).join("\n"),l="productive"===t?(e=>{if(!e||0===e.length)return"";let t=JSON.stringify(e&&e.length>0?e:[],null,2);return`<todo_list>
${t}
</todo_list>`})(o):"",d=e?`- To send a private message, use "trigger_agent_dm" and set "target" to the recipient agent id or "user".
- Use public messages by default; choose DM only when the message MUST be private.`:"";return`
You are a conversation supervisor for a group chat with multiple AI agents. Your role is to orchestrate a group of agents to make user feel natural and interactive.

<group_role>
${a||""}
</group_role>

<group_members>
${s}
</group_members>

<conversation_history>
${r}
</conversation_history>

${l}

RULES:

- Do not forcing user to respond, only ask for information for one time before you get the information you need.
- Make the group conversation feels like a real conversation.

WHEN ASKING AGENTS TO SPEAK:

- Only reference agents from the member list. Never invent new IDs.
- Do not excessivly gathering information from user, you should only ask for information when it's necessary.
- If need many information from user, make single agent to ask for all.
${d}

${"productive"===t?`WHEN GENERATING TODOS:

- Only use Todo for complex tasks.
- Break down the main objective into logical, sequential tasks.
- Be concise and to the point. Each todo should no longer than 10 words. Do not create more than 5 todos.
- Match user's message language.
- By only assigning todo will not tirgger agent response you still need to use trigger tool if needed.
- Keep todo items synchronized with the context. Finish or create todos as progress changes.`:""}
`.trim()}},h=({chunks:e,knowledge:t,userQuery:i,rewriteQuery:r})=>{if((e||[])?.length===0)return"";let o=(t||[]).map(e=>e.name).join("/");return`<knowledge_base_qa_info>
You are also a helpful assistant good answering questions related to ${o}. And you'll be provided with a question and several passages that might be relevant. And currently your task is to provide answer based on the question and passages.
<knowledge_base_anwser_instruction>
- Note that passages might not be relevant to the question, please only use the passages that are relevant.
- if there is no relevant passage, please answer using your knowledge.
- Answer should use the same original language as the question and follow markdown syntax.
</knowledge_base_anwser_instruction>
${0===(t||[]).length?"":`<knowledge_bases>
<knowledge_bases_docstring>here are the knowledge base scope we retrieve chunks from:</knowledge_bases_docstring>
${t?.map(e=>`<knowledge id="${e.id}" name="${e.name}" type="${e.type}"${e.fileType?` fileType="${e.fileType}" `:""}>${e.description||""}</knowledge>`).join("\n")}
</knowledge_bases>`.trim()}
${e?0===e.length?"":`<retrieved_chunks>
<retrieved_chunks_docstring>here are retrived chunks you can refer to:</retrieved_chunks_docstring>
${e.map(e=>`<chunk fileId="${e.fileId}" fileName="${e.fileName}" similarity="${e.similarity}" ${e.pageNumber?` pageNumber="${e.pageNumber}" `:""}>${e.text}</chunk>`).join("\n")}
</retrieved_chunks>`.trim():""}
${`<user_query>
<user_query_docstring>to make result better, we may rewrite user's question.If there is a rewrite query, it will be wrapper with \`rewrite_query\` tag.</user_query_docstring>

<raw_query>${i.trim()}</raw_query>
${r?`<rewrite_query>${r.trim()}</rewrite_query>`:""}
<user_query>`}
</knowledge_base_qa_info>`},v=({tools:e})=>`<plugins description="The plugins you can use below">
${!(e.length>0)?"":e.map(e=>`<collection name="${e.name}">
${e.systemRole?`<collection.instructions>${e.systemRole}</collection.instructions>`:""}
${e.apis.map(e=>`<api identifier="${e.name}">${e.desc}</api>`).join("\n")}
</collection>`).join("\n")}
</plugins>`.trim(),y=e=>e?e.replaceAll("&","&amp;").replaceAll('"',"&quot;").replaceAll("<","&lt;").replaceAll(">","&gt;"):"",f=e=>e?e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;"):"",A=e=>{if(0===e.length)return"<no_crawl_results />";let t=e.map(e=>{if("errorMessage"in e){let t=[`errorType="${y(e.errorType)}"`,`errorMessage="${y(e.errorMessage)}"`];return e.url&&t.push(`url="${y(e.url)}"`),`  <error ${t.join(" ")} />`}let t=[`url="${y(e.url)}"`];e.title&&t.push(`title="${y(e.title)}"`),e.contentType&&t.push(`contentType="${y(e.contentType)}"`),e.description&&t.push(`description="${y(e.description)}"`),void 0!==e.length&&t.push(`length="${e.length}"`);let i=t.join(" "),r=e.content?f(e.content):"";return r?`  <page ${i}>${r}</page>`:`  <page ${i} />`}).join("\n");return`<crawlResults>
${t}
</crawlResults>`},P=e=>{if(0===e.length)return"<searchResults />";let t=e.map(e=>{let t=[`title="${y(e.title)}"`,`url="${y(e.url)}"`];e.publishedDate&&t.push(`publishedDate="${y(e.publishedDate)}"`),e.imgSrc&&t.push(`imgSrc="${y(e.imgSrc)}"`),e.thumbnail&&t.push(`thumbnail="${y(e.thumbnail)}"`);let i=t.join(" "),r=e.content?f(e.content):"";return r?`  <item ${i}>${r}</item>`:`  <item ${i} />`}).join("\n");return`<searchResults>
${t}
</searchResults>`},w=e=>`<chat_history_summary>
<docstring>Users may have lots of chat messages, here is the summary of the history:</docstring>
<summary>${e}</summary>
</chat_history_summary>
`,b=e=>({messages:[{content:"You're an assistant who's good at extracting key takeaways from conversations and summarizing them. Please summarize according to the user's needs. The content you need to summarize is located in the <chat_history> </chat_history> group of xml tags. The summary needs to maintain the original language.",role:"system"},{content:`<chat_history>
${e.map(e=>`<${e.role}>${e.content}</${e.role}>`).join("\n")}
</chat_history>

Please summarize the above conversation and retain key information. The summarized content will be used as context for subsequent prompts, and should be limited to 400 tokens.`,role:"user"}]}),M=(e,t)=>({messages:[{content:"ä½ æ˜¯ä¸€åæ“…é•¿ä¼šè¯æ ‡ç­¾æ€»ç»“çš„åŠ©ç†ï¼Œä½ éœ€è¦å°†ç”¨æˆ·çš„è¾“å…¥çš„å†…å®¹æç‚¼å‡ºåˆ†ç±»æ ‡ç­¾ï¼Œä½¿ç”¨`,`åˆ†éš”ï¼Œä¸è¶…è¿‡ 5 ä¸ªæ ‡ç­¾ï¼Œå¹¶ç¿»è¯‘ä¸ºç›®æ ‡è¯­è¨€ã€‚ æ ¼å¼è¦æ±‚å¦‚ä¸‹ï¼š\nè¾“å…¥: {æ–‡æœ¬ä½œä¸ºJSONå¼•ç”¨å­—ç¬¦ä¸²} [locale]\nè¾“å‡º: {æ ‡ç­¾}",role:"system"},{content:`è¾“å…¥: {ä½ æ˜¯ä¸€åæ–‡æ¡ˆå¤§å¸ˆï¼Œå¸®æˆ‘ä¸ºä¸€äº›è®¾è®¡ / è‰ºæœ¯ä½œå“èµ·åï¼Œåå­—éœ€è¦æœ‰æ–‡å­¦å†…æ¶µï¼Œæ³¨é‡ç²¾ç‚¼å’Œèµ‹å­æ„å¢ƒï¼Œè¡¨è¾¾ä½œå“çš„æƒ…æ™¯æ°›å›½ï¼Œä½¿åç§°æ—¢ç®€æ´åˆå¯Œæœ‰è¯—æ„ã€‚} [zh-CN]`,role:"user"},{content:"èµ·å,å†™ä½œ,åˆ›æ„",role:"assistant"},{content:`è¾“å…¥: {You are a professional translator proficient in Simplified Chinese, and have participated in the translation work of the Chinese versions of The New York Times and The Economist. Therefore, you have a deep understanding of translating news and current affairs articles. I hope you can help me translate the following English news paragraphs into Chinese, with a style similar to the Chinese versions of the aforementioned magazines.} [zh-CN]`,role:"user"},{content:"ç¿»è¯‘,å†™ä½œ,æ–‡æ¡ˆ",role:"assistant"},{content:`è¾“å…¥: {ä½ æ˜¯ä¸€ååˆ›ä¸šè®¡åˆ’æ’°å†™ä¸“å®¶ï¼Œå¯ä»¥æä¾›åŒ…æ‹¬åˆ›æ„åç§°ã€ç®€çŸ­çš„æ ‡è¯­ã€ç›®æ ‡ç”¨æˆ·ç”»åƒã€ç”¨æˆ·ç—›ç‚¹ã€ä¸»è¦ä»·å€¼ä¸»å¼ ã€é”€å”®/è¥é”€æ¸ é“ã€æ”¶å…¥æµã€æˆæœ¬ç»“æž„ç­‰è®¡åˆ’ç”Ÿæˆã€‚} [en-US]`,role:"user"},{content:"entrepreneurship,planning,consulting",role:"assistant"},{content:`è¾“å…¥: {${e}} [${t}]`,role:"user"}]}),_=(e,t)=>({messages:[{content:`You are a professional conversation summarizer. Generate a concise title that captures the essence of the conversation.

Rules:
- Output ONLY the title text, no explanations or additional context
- Maximum 10 words
- Maximum 50 characters
- No punctuation marks
- Use the language specified by the locale code: ${t}
- The title should accurately reflect the main topic of the conversation
- Keep it short and to the point`,role:"system"},{content:e.map(e=>`${e.role}: ${e.content}`).join("\n"),role:"user"}]}),$=(e,t)=>({messages:[{content:`You are a professional translator. Translate the input text to ${t}.

Rules:
- Output ONLY the translated text, no explanations or additional context
- Preserve technical terms, code identifiers, API keys, and proper nouns exactly as they appear
- Maintain the original formatting and structure
- Use natural, idiomatic expressions in the target language`,role:"system"},{content:e,role:"user"}]}),I="create_todo",T="finish_todo",L="trigger_agent_dm",S=[{description:"Trigger an agent to speak (group message).",name:"trigger_agent",parameters:{properties:{id:{description:"The agent id to trigger.",type:"string"},instruction:{description:"The instruction or message for the agent. No longer than 10 words. Always use English.",type:"string"}},required:["id","instruction"],type:"object"}},{description:"Wait for user input. Use this when the conversation history looks likes fine for now, or agents are waiting for user input.",name:"wait_for_user_input",parameters:{properties:{reason:{description:"Optional reason for pausing the conversation.",type:"string"}},required:[],type:"object"}},{description:"Trigger an agent to DM another agent or user.",name:L,parameters:{additionalProperties:!1,properties:{id:{description:"The agent id to trigger.",type:"string"},instruction:{type:"string"},target:{description:"The target agent id. Only used when need DM.",type:"string"}},required:["instruction","id","target"],type:"object"}},{description:"Create a new todo item",name:I,parameters:{additionalProperties:!1,properties:{assignee:{description:"Who will do the todo. Can be agent id or empty.",type:"string"},content:{description:"The todo content or description.",type:"string"}},required:["content","assignee"],type:"object"}},{description:"Finish a todo by index or all todos",name:T,parameters:{additionalProperties:!1,properties:{index:{type:"number"}},required:["index"],type:"object"}}],k=({allowDM:e,scene:t,systemPrompt:i,availableAgents:r,todoList:o,userName:a,messages:n})=>{let s=u(n);return{messages:[{content:p.buildSupervisorPrompt({allowDM:e,availableAgents:r.filter(e=>e.id),conversationHistory:s,scene:t,systemPrompt:i,todoList:o,userName:a}),role:"user"}],temperature:.3,tools:S.filter(i=>i.name===L?e:![T,I].includes(i.name)||"productive"===t).map(e=>({function:e,type:"function"}))}}},42897:(e,t,i)=>{i.d(t,{fe:()=>a,w0:()=>s});var r=i(74551),o=i(67095);let a=e=>(0,o.h)(e.defaultSettings,e.settings),n=e=>(0,o.h)(r.kz,a(e).defaultAgent),s={currentImageSettings:e=>a(e).image,currentSettings:a,currentSystemAgent:e=>(0,o.h)(r.fw,a(e).systemAgent),currentTTS:e=>(0,o.h)(r.Ff,a(e).tts),defaultAgent:n,defaultAgentConfig:e=>(0,o.h)(r.HA,n(e).config),defaultAgentMeta:e=>(0,o.h)(r.M3,n(e).meta),exportSettings:a,getHotkeyById:e=>t=>(0,o.h)(r.Ke,a(t).hotkey)[e],providerConfig:e=>t=>(a(t).languageModel||{})[e]}},61520:(e,t,i)=>{i.d(t,{P:()=>d,f:()=>l});var r=i(74551),o=i(96987),a=i(96773);let n=r.Se,s=e=>a.S4?e.isSignedIn?e.user?.username:"anonymous":r.xl?e.user?.username:n,l={displayUserName:e=>s(e)||e.user?.email||"",email:e=>e.user?.email||"",fullName:e=>e.user?.fullName||"",nickName:e=>{let t=e.user?.fullName||e.user?.username;return a.S4?e.isSignedIn?t:(0,o.t)("userPanel.anonymousNickName",{ns:"common"}):r.xl?t:(0,o.t)("userPanel.defaultNickname",{ns:"common"})},userAvatar:e=>e.user?.avatar||"",userId:e=>e.user?.id,userProfile:e=>e.user,username:s},d={isLoaded:e=>e.isLoaded,isLogin:e=>!a.S4||e.isSignedIn,isLoginWithAuth:e=>e.isSignedIn,isLoginWithClerk:e=>e.isSignedIn&&a.Nd||!1,isLoginWithNextAuth:e=>e.isSignedIn&&!!a.J_||!1}},94147:(e,t,i)=>{i.d(t,{l:()=>N,d:()=>R});var r,o=i(50786),a=i(23993),n=i(41734);let s={activeProviderModelList:[],aiProviderConfigUpdatingIds:[],aiProviderList:[],aiProviderLoadingIds:[],aiProviderRuntimeConfig:{},initAiProviderList:!1,isInitAiProviderRuntimeState:!1,providerSearchKeyword:"",aiModelLoadingIds:[],aiProviderModelList:[],builtinAiModelList:[],modelSearchKeyword:""};var l=i(31021),d=i.n(l),u=i(64911),c=i(46265),g=i(77605);class m{constructor(){this.createAiModel=async e=>g.du.aiModel.createAiModel.mutate(e),this.getAiProviderModelList=async e=>g.du.aiModel.getAiProviderModelList.query({id:e}),this.getAiModelById=async e=>g.du.aiModel.getAiModelById.query({id:e}),this.toggleModelEnabled=async e=>g.du.aiModel.toggleModelEnabled.mutate(e),this.updateAiModel=async(e,t,i)=>g.du.aiModel.updateAiModel.mutate({id:e,providerId:t,value:i}),this.batchUpdateAiModels=async(e,t)=>g.du.aiModel.batchUpdateAiModels.mutate({id:e,models:t}),this.batchToggleAiModels=async(e,t,i)=>g.du.aiModel.batchToggleAiModels.mutate({enabled:i,id:e,models:t}),this.clearModelsByProvider=async e=>g.du.aiModel.clearModelsByProvider.mutate({providerId:e}),this.clearRemoteModels=async e=>g.du.aiModel.clearRemoteModels.mutate({providerId:e}),this.updateAiModelOrder=async(e,t)=>g.du.aiModel.updateAiModelOrder.mutate({providerId:e,sortMap:t}),this.deleteAiModel=async e=>g.du.aiModel.removeAiModel.mutate(e)}}let p=new m,h="FETCH_AI_PROVIDER_MODELS";var v=i(74551),y=i(16748),f=i(61505),A=i(5750),P=i(38759),w=i(61520),b=i(77186);let M=(e,t)=>async(i,r)=>{let o,a=i.filter(t=>t.providerId===r&&t.type===e);return a.length?(o=await Promise.all(a.map(e=>t(e))),(0,f.A)(o,"id")):[]},_=async e=>{let t=e.parameters?Promise.resolve(e.parameters):(0,y.TS)(e.id,"parameters",e.providerId),i=e.pricing?Promise.resolve(e.pricing):(0,y.TS)(e.id,"pricing",e.providerId),r=(0,y.TS)(e.id,"description",e.providerId),[o,a,n]=await Promise.all([t,i,r]),s=e.parameters??o,{price:l,approximatePrice:d}=(0,y.r7)(a);return{abilities:e.abilities||{},contextWindowTokens:e.contextWindowTokens,displayName:e.displayName??"",id:e.id,...s&&{parameters:s},...n&&{description:n},...a&&{pricing:a},..."number"==typeof d&&{approximatePricePerImage:d},..."number"==typeof l&&{pricePerImage:l}}},$=M("chat",async e=>({abilities:e.abilities||{},contextWindowTokens:e.contextWindowTokens,displayName:e.displayName??"",id:e.id})),I=M("image",_),T=async(e,t,i)=>Promise.all(e.map(async e=>({...e,children:await i(t,e.id),name:e.name||e.id}))),L=async(e,t)=>T(e,t,I),S=async(e,t)=>T(e,t,$);var k=((r=k||{}).fetchAiProviderItem="FETCH_AI_PROVIDER_ITEM",r.fetchAiProviderList="FETCH_AI_PROVIDER",r.fetchAiProviderRuntimeState="FETCH_AI_PROVIDER_RUNTIME_STATE",r);let E=(0,n.t)("aiInfra"),R=(0,a.h)()(E((...e)=>({...s,...((e,t)=>({batchToggleAiModels:async(e,i)=>{let{activeAiProvider:r}=t();r&&(await p.batchToggleAiModels(r,e,i),await t().refreshAiModelList())},batchUpdateAiModels:async e=>{let{activeAiProvider:i}=t();i&&(await p.batchUpdateAiModels(i,e),await t().refreshAiModelList())},clearModelsByProvider:async e=>{await p.clearModelsByProvider(e),await t().refreshAiModelList()},clearRemoteModels:async e=>{await p.clearRemoteModels(e),await t().refreshAiModelList()},createNewAiModel:async e=>{await p.createAiModel(e),await t().refreshAiModelList()},fetchRemoteModelList:async e=>{let{modelsService:r}=await Promise.all([i.e(83663),i.e(85614),i.e(91416)]).then(i.bind(i,91416)),o=await r.getModels(e);o&&(await t().batchUpdateAiModels(o.map(e=>({...e,abilities:{files:e.files,functionCall:e.functionCall,imageOutput:e.imageOutput,reasoning:e.reasoning,search:e.search,video:e.video,vision:e.vision},enabled:e.enabled||!1,source:"remote",type:e.type||"chat"}))),await t().refreshAiModelList())},internal_toggleAiModelLoading:(t,i)=>{e(e=>i?{aiModelLoadingIds:[...e.aiModelLoadingIds,t]}:{aiModelLoadingIds:e.aiModelLoadingIds.filter(e=>e!==t)},!1,"toggleAiModelLoading")},refreshAiModelList:async()=>{await (0,u.j)([h,t().activeAiProvider]),t().refreshAiProviderRuntimeState()},removeAiModel:async(e,i)=>{await p.deleteAiModel({id:e,providerId:i}),await t().refreshAiModelList()},toggleModelEnabled:async e=>{let{activeAiProvider:i}=t();i&&(t().internal_toggleAiModelLoading(e.id,!0),await p.toggleModelEnabled({...e,providerId:i}),await t().refreshAiModelList(),t().internal_toggleAiModelLoading(e.id,!1))},updateAiModelsConfig:async(e,i,r)=>{await p.updateAiModel(e,i,r),await t().refreshAiModelList()},updateAiModelsSort:async(e,i)=>{await p.updateAiModelOrder(e,i),await t().refreshAiModelList()},useFetchAiProviderModels:i=>(0,c.lA)([h,i],([,e])=>p.getAiProviderModelList(e),{onSuccess:r=>{t().isAiModelListInit&&d()(r,t().aiProviderModelList)||e({aiProviderModelList:r,isAiModelListInit:!0},!1,`useFetchAiProviderModels/${i}`)}})}))(...e),...((e,t)=>({createNewAiProvider:async e=>{await A.F.createAiProvider({...e,source:b.Ag.Custom}),await t().refreshAiProviderList()},deleteAiProvider:async e=>{await A.F.deleteAiProvider(e),await t().refreshAiProviderList()},internal_toggleAiProviderConfigUpdating:(t,i)=>{e(e=>i?{aiProviderConfigUpdatingIds:[...e.aiProviderConfigUpdatingIds,t]}:{aiProviderConfigUpdatingIds:e.aiProviderConfigUpdatingIds.filter(e=>e!==t)},!1,"toggleAiProviderLoading")},internal_toggleAiProviderLoading:(t,i)=>{e(e=>i?{aiProviderLoadingIds:[...e.aiProviderLoadingIds,t]}:{aiProviderLoadingIds:e.aiProviderLoadingIds.filter(e=>e!==t)},!1,"toggleAiProviderLoading")},refreshAiProviderDetail:async()=>{await (0,u.j)(["FETCH_AI_PROVIDER_ITEM",t().activeAiProvider]),await t().refreshAiProviderRuntimeState()},refreshAiProviderList:async()=>{await (0,u.j)("FETCH_AI_PROVIDER"),await t().refreshAiProviderRuntimeState()},refreshAiProviderRuntimeState:async()=>{await Promise.all([(0,u.j)(["FETCH_AI_PROVIDER_RUNTIME_STATE",!0]),(0,u.j)(["FETCH_AI_PROVIDER_RUNTIME_STATE",!1])])},removeAiProvider:async e=>{await A.F.deleteAiProvider(e),await t().refreshAiProviderList()},toggleProviderEnabled:async(e,i)=>{t().internal_toggleAiProviderLoading(e,!0),await A.F.toggleProviderEnabled(e,i),await t().refreshAiProviderList(),t().internal_toggleAiProviderLoading(e,!1)},updateAiProvider:async(e,i)=>{t().internal_toggleAiProviderLoading(e,!0),await A.F.updateAiProvider(e,i),await t().refreshAiProviderList(),await t().refreshAiProviderDetail(),t().internal_toggleAiProviderLoading(e,!1)},updateAiProviderConfig:async(e,i)=>{t().internal_toggleAiProviderConfigUpdating(e,!0),await A.F.updateAiProviderConfig(e,i),await t().refreshAiProviderDetail(),t().internal_toggleAiProviderConfigUpdating(e,!1)},updateAiProviderSort:async e=>{await A.F.updateAiProviderOrder(e),await t().refreshAiProviderList()},useFetchAiProviderItem:t=>(0,c.lA)(["FETCH_AI_PROVIDER_ITEM",t],()=>A.F.getAiProviderById(t),{onSuccess:i=>{i&&e({activeAiProvider:t,aiProviderDetail:i},!1,"useFetchAiProviderItem")}}),useFetchAiProviderList:i=>(0,c.lA)(i?.enabled===!1?null:"FETCH_AI_PROVIDER",()=>A.F.getAiProviderList(),{fallbackData:[],onSuccess:i=>{t().initAiProviderList?e({aiProviderList:i},!1,"useFetchAiProviderList/refresh"):e({aiProviderList:i,initAiProviderList:!0},!1,"useFetchAiProviderList/init")}}),useFetchAiProviderRuntimeState:t=>{let r=w.P.isLoaded(P.k.getState())&&null!=t;return(0,c.lA)(r?["FETCH_AI_PROVIDER_RUNTIME_STATE",t]:null,async([,e])=>{let[{LOBE_DEFAULT_MODEL_LIST:t},{DEFAULT_MODEL_PROVIDER_LIST:r}]=await Promise.all([Promise.resolve().then(i.bind(i,80286)),Promise.resolve().then(i.bind(i,67400))]);if(e){let e=await A.F.getAiProviderRuntimeState(),[i,r]=await Promise.all([S(e.enabledChatAiProviders,e.enabledAiModels),L(e.enabledImageAiProviders,e.enabledAiModels)]);return{...e,builtinAiModelList:t,enabledChatModelList:i,enabledImageModelList:r}}let o=r.filter(e=>e.enabled).map(e=>({id:e.id,name:e.name,source:b.Ag.Builtin})),a=o.filter(e=>t.some(t=>t.providerId===e.id&&"chat"===t.type)),n=o.filter(e=>t.some(t=>t.providerId===e.id&&"image"===t.type)).map(e=>({id:e.id,name:e.name,source:b.Ag.Builtin})),s=t.filter(e=>e.enabled),[l,d]=await Promise.all([S(a,s),L(n,s)]);return{builtinAiModelList:t,enabledAiModels:s,enabledAiProviders:o,enabledChatAiProviders:a,enabledChatModelList:l,enabledImageAiProviders:n,enabledImageModelList:d,runtimeConfig:{}}},{focusThrottleInterval:v.xl?100:void 0,onSuccess:t=>{t&&e({aiProviderRuntimeConfig:t.runtimeConfig,builtinAiModelList:t.builtinAiModelList,enabledAiModels:t.enabledAiModels,enabledAiProviders:t.enabledAiProviders,enabledChatModelList:t.enabledChatModelList||[],enabledImageModelList:t.enabledImageModelList||[],isInitAiProviderRuntimeState:!0},!1,"useFetchAiProviderRuntimeState")}})}}))(...e)})),o.x),N=()=>R.getState()}}]);